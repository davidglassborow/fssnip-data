<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">  1: </span>
<span class="l">  2: </span>
<span class="l">  3: </span>
<span class="l">  4: </span>
<span class="l">  5: </span>
<span class="l">  6: </span>
<span class="l">  7: </span>
<span class="l">  8: </span>
<span class="l">  9: </span>
<span class="l"> 10: </span>
<span class="l"> 11: </span>
<span class="l"> 12: </span>
<span class="l"> 13: </span>
<span class="l"> 14: </span>
<span class="l"> 15: </span>
<span class="l"> 16: </span>
<span class="l"> 17: </span>
<span class="l"> 18: </span>
<span class="l"> 19: </span>
<span class="l"> 20: </span>
<span class="l"> 21: </span>
<span class="l"> 22: </span>
<span class="l"> 23: </span>
<span class="l"> 24: </span>
<span class="l"> 25: </span>
<span class="l"> 26: </span>
<span class="l"> 27: </span>
<span class="l"> 28: </span>
<span class="l"> 29: </span>
<span class="l"> 30: </span>
<span class="l"> 31: </span>
<span class="l"> 32: </span>
<span class="l"> 33: </span>
<span class="l"> 34: </span>
<span class="l"> 35: </span>
<span class="l"> 36: </span>
<span class="l"> 37: </span>
<span class="l"> 38: </span>
<span class="l"> 39: </span>
<span class="l"> 40: </span>
<span class="l"> 41: </span>
<span class="l"> 42: </span>
<span class="l"> 43: </span>
<span class="l"> 44: </span>
<span class="l"> 45: </span>
<span class="l"> 46: </span>
<span class="l"> 47: </span>
<span class="l"> 48: </span>
<span class="l"> 49: </span>
<span class="l"> 50: </span>
<span class="l"> 51: </span>
<span class="l"> 52: </span>
<span class="l"> 53: </span>
<span class="l"> 54: </span>
<span class="l"> 55: </span>
<span class="l"> 56: </span>
<span class="l"> 57: </span>
<span class="l"> 58: </span>
<span class="l"> 59: </span>
<span class="l"> 60: </span>
<span class="l"> 61: </span>
<span class="l"> 62: </span>
<span class="l"> 63: </span>
<span class="l"> 64: </span>
<span class="l"> 65: </span>
<span class="l"> 66: </span>
<span class="l"> 67: </span>
<span class="l"> 68: </span>
<span class="l"> 69: </span>
<span class="l"> 70: </span>
<span class="l"> 71: </span>
<span class="l"> 72: </span>
<span class="l"> 73: </span>
<span class="l"> 74: </span>
<span class="l"> 75: </span>
<span class="l"> 76: </span>
<span class="l"> 77: </span>
<span class="l"> 78: </span>
<span class="l"> 79: </span>
<span class="l"> 80: </span>
<span class="l"> 81: </span>
<span class="l"> 82: </span>
<span class="l"> 83: </span>
<span class="l"> 84: </span>
<span class="l"> 85: </span>
<span class="l"> 86: </span>
<span class="l"> 87: </span>
<span class="l"> 88: </span>
<span class="l"> 89: </span>
<span class="l"> 90: </span>
<span class="l"> 91: </span>
<span class="l"> 92: </span>
<span class="l"> 93: </span>
<span class="l"> 94: </span>
<span class="l"> 95: </span>
<span class="l"> 96: </span>
<span class="l"> 97: </span>
<span class="l"> 98: </span>
<span class="l"> 99: </span>
<span class="l">100: </span>
<span class="l">101: </span>
<span class="l">102: </span>
<span class="l">103: </span>
<span class="l">104: </span>
<span class="l">105: </span>
<span class="l">106: </span>
<span class="l">107: </span>
<span class="l">108: </span>
<span class="l">109: </span>
<span class="l">110: </span>
<span class="l">111: </span>
<span class="l">112: </span>
<span class="l">113: </span>
<span class="l">114: </span>
<span class="l">115: </span>
<span class="l">116: </span>
<span class="l">117: </span>
<span class="l">118: </span>
<span class="l">119: </span>
<span class="l">120: </span>
<span class="l">121: </span>
<span class="l">122: </span>
<span class="l">123: </span>
<span class="l">124: </span>
<span class="l">125: </span>
<span class="l">126: </span>
<span class="l">127: </span>
<span class="l">128: </span>
<span class="l">129: </span>
<span class="l">130: </span>
<span class="l">131: </span>
<span class="l">132: </span>
<span class="l">133: </span>
<span class="l">134: </span>
<span class="l">135: </span>
<span class="l">136: </span>
<span class="l">137: </span>
<span class="l">138: </span>
<span class="l">139: </span>
<span class="l">140: </span>
<span class="l">141: </span>
<span class="l">142: </span>
<span class="l">143: </span>
<span class="l">144: </span>
<span class="l">145: </span>
<span class="l">146: </span>
<span class="l">147: </span>
<span class="l">148: </span>
<span class="l">149: </span>
<span class="l">150: </span>
<span class="l">151: </span>
<span class="l">152: </span>
<span class="l">153: </span>
<span class="l">154: </span>
<span class="l">155: </span>
<span class="l">156: </span>
<span class="l">157: </span>
<span class="l">158: </span>
<span class="l">159: </span>
<span class="l">160: </span>
<span class="l">161: </span>
<span class="l">162: </span>
<span class="l">163: </span>
<span class="l">164: </span>
<span class="l">165: </span>
<span class="l">166: </span>
<span class="l">167: </span>
<span class="l">168: </span>
<span class="l">169: </span>
<span class="l">170: </span>
<span class="l">171: </span>
<span class="l">172: </span>
<span class="l">173: </span>
<span class="l">174: </span>
<span class="l">175: </span>
<span class="l">176: </span>
<span class="l">177: </span>
<span class="l">178: </span>
<span class="l">179: </span>
<span class="l">180: </span>
<span class="l">181: </span>
<span class="l">182: </span>
<span class="l">183: </span>
<span class="l">184: </span>
<span class="l">185: </span>
<span class="l">186: </span>
<span class="l">187: </span>
<span class="l">188: </span>
<span class="l">189: </span>
<span class="l">190: </span>
<span class="l">191: </span>
<span class="l">192: </span>
<span class="l">193: </span>
<span class="l">194: </span>
<span class="l">195: </span>
<span class="l">196: </span>
<span class="l">197: </span>
<span class="l">198: </span>
<span class="l">199: </span>
<span class="l">200: </span>
<span class="l">201: </span>
<span class="l">202: </span>
<span class="l">203: </span>
<span class="l">204: </span>
<span class="l">205: </span>
<span class="l">206: </span>
<span class="l">207: </span>
<span class="l">208: </span>
<span class="l">209: </span>
<span class="l">210: </span>
<span class="l">211: </span>
<span class="l">212: </span>
<span class="l">213: </span>
<span class="l">214: </span>
<span class="l">215: </span>
<span class="l">216: </span>
<span class="l">217: </span>
<span class="l">218: </span>
<span class="l">219: </span>
<span class="l">220: </span>
<span class="l">221: </span>
<span class="l">222: </span>
<span class="l">223: </span>
<span class="l">224: </span>
<span class="l">225: </span>
<span class="l">226: </span>
<span class="l">227: </span>
<span class="l">228: </span>
<span class="l">229: </span>
<span class="l">230: </span>
<span class="l">231: </span>
<span class="l">232: </span>
<span class="l">233: </span>
<span class="l">234: </span>
<span class="l">235: </span>
<span class="l">236: </span>
<span class="l">237: </span>
<span class="l">238: </span>
<span class="l">239: </span>
<span class="l">240: </span>
<span class="l">241: </span>
<span class="l">242: </span>
<span class="l">243: </span>
<span class="l">244: </span>
<span class="l">245: </span>
<span class="l">246: </span>
<span class="l">247: </span>
<span class="l">248: </span>
<span class="l">249: </span>
<span class="l">250: </span>
<span class="l">251: </span>
<span class="l">252: </span>
<span class="l">253: </span>
<span class="l">254: </span>
<span class="l">255: </span>
<span class="l">256: </span>
<span class="l">257: </span>
<span class="l">258: </span>
<span class="l">259: </span>
<span class="l">260: </span>
<span class="l">261: </span>
<span class="l">262: </span>
<span class="l">263: </span>
<span class="l">264: </span>
<span class="l">265: </span>
<span class="l">266: </span>
<span class="l">267: </span>
<span class="l">268: </span>
<span class="l">269: </span>
<span class="l">270: </span>
<span class="l">271: </span>
<span class="l">272: </span>
<span class="l">273: </span>
<span class="l">274: </span>
<span class="l">275: </span>
<span class="l">276: </span>
<span class="l">277: </span>
<span class="l">278: </span>
<span class="l">279: </span>
<span class="l">280: </span>
<span class="l">281: </span>
<span class="l">282: </span>
<span class="l">283: </span>
<span class="l">284: </span>
<span class="l">285: </span>
<span class="l">286: </span>
<span class="l">287: </span>
<span class="l">288: </span>
<span class="l">289: </span>
<span class="l">290: </span>
<span class="l">291: </span>
<span class="l">292: </span>
<span class="l">293: </span>
<span class="l">294: </span>
<span class="l">295: </span>
<span class="l">296: </span>
<span class="l">297: </span>
<span class="l">298: </span>
<span class="l">299: </span>
<span class="l">300: </span>
<span class="l">301: </span>
<span class="l">302: </span>
<span class="l">303: </span>
<span class="l">304: </span>
<span class="l">305: </span>
<span class="l">306: </span>
<span class="l">307: </span>
<span class="l">308: </span>
<span class="l">309: </span>
<span class="l">310: </span>
<span class="l">311: </span>
<span class="l">312: </span>
<span class="l">313: </span>
<span class="l">314: </span>
<span class="l">315: </span>
<span class="l">316: </span>
<span class="l">317: </span>
<span class="l">318: </span>
<span class="l">319: </span>
<span class="l">320: </span>
<span class="l">321: </span>
<span class="l">322: </span>
<span class="l">323: </span>
<span class="l">324: </span>
<span class="l">325: </span>
<span class="l">326: </span>
<span class="l">327: </span>
<span class="l">328: </span>
<span class="l">329: </span>
<span class="l">330: </span>
<span class="l">331: </span>
<span class="l">332: </span>
<span class="l">333: </span>
<span class="l">334: </span>
<span class="l">335: </span>
<span class="l">336: </span>
<span class="l">337: </span>
<span class="l">338: </span>
<span class="l">339: </span>
<span class="l">340: </span>
<span class="l">341: </span>
<span class="l">342: </span>
<span class="l">343: </span>
<span class="l">344: </span>
<span class="l">345: </span>
<span class="l">346: </span>
<span class="l">347: </span>
<span class="l">348: </span>
<span class="l">349: </span>
<span class="l">350: </span>
<span class="l">351: </span>
<span class="l">352: </span>
<span class="l">353: </span>
<span class="l">354: </span>
<span class="l">355: </span>
<span class="l">356: </span>
<span class="l">357: </span>
<span class="l">358: </span>
<span class="l">359: </span>
<span class="l">360: </span>
<span class="l">361: </span>
<span class="l">362: </span>
<span class="l">363: </span>
<span class="l">364: </span>
<span class="l">365: </span>
<span class="l">366: </span>
<span class="l">367: </span>
<span class="l">368: </span>
<span class="l">369: </span>
<span class="l">370: </span>
<span class="l">371: </span>
<span class="l">372: </span>
<span class="l">373: </span>
<span class="l">374: </span>
<span class="l">375: </span>
<span class="l">376: </span>
<span class="l">377: </span>
<span class="l">378: </span>
<span class="l">379: </span>
<span class="l">380: </span>
<span class="l">381: </span>
<span class="l">382: </span>
<span class="l">383: </span>
<span class="l">384: </span>
<span class="l">385: </span>
<span class="l">386: </span>
<span class="l">387: </span>
<span class="l">388: </span>
<span class="l">389: </span>
<span class="l">390: </span>
<span class="l">391: </span>
<span class="l">392: </span>
<span class="l">393: </span>
<span class="l">394: </span>
<span class="l">395: </span>
<span class="l">396: </span>
<span class="l">397: </span>
<span class="l">398: </span>
<span class="l">399: </span>
<span class="l">400: </span>
<span class="l">401: </span>
<span class="l">402: </span>
<span class="l">403: </span>
<span class="l">404: </span>
<span class="l">405: </span>
<span class="l">406: </span>
<span class="l">407: </span>
<span class="l">408: </span>
<span class="l">409: </span>
<span class="l">410: </span>
<span class="l">411: </span>
<span class="l">412: </span>
<span class="l">413: </span>
<span class="l">414: </span>
<span class="l">415: </span>
<span class="l">416: </span>
<span class="l">417: </span>
<span class="l">418: </span>
<span class="l">419: </span>
<span class="l">420: </span>
<span class="l">421: </span>
<span class="l">422: </span>
<span class="l">423: </span>
<span class="l">424: </span>
<span class="l">425: </span>
<span class="l">426: </span>
<span class="l">427: </span>
<span class="l">428: </span>
<span class="l">429: </span>
<span class="l">430: </span>
<span class="l">431: </span>
<span class="l">432: </span>
<span class="l">433: </span>
<span class="l">434: </span>
<span class="l">435: </span>
<span class="l">436: </span>
<span class="l">437: </span>
<span class="l">438: </span>
<span class="l">439: </span>
<span class="l">440: </span>
<span class="l">441: </span>
<span class="l">442: </span>
<span class="l">443: </span>
<span class="l">444: </span>
<span class="l">445: </span>
<span class="l">446: </span>
<span class="l">447: </span>
<span class="l">448: </span>
<span class="l">449: </span>
<span class="l">450: </span>
<span class="l">451: </span>
<span class="l">452: </span>
<span class="l">453: </span>
<span class="l">454: </span>
<span class="l">455: </span>
<span class="l">456: </span>
<span class="l">457: </span>
<span class="l">458: </span>
<span class="l">459: </span>
<span class="l">460: </span>
<span class="l">461: </span>
<span class="l">462: </span>
<span class="l">463: </span>
<span class="l">464: </span>
<span class="l">465: </span>
<span class="l">466: </span>
<span class="l">467: </span>
<span class="l">468: </span>
<span class="l">469: </span>
<span class="l">470: </span>
<span class="l">471: </span>
<span class="l">472: </span>
<span class="l">473: </span>
<span class="l">474: </span>
<span class="l">475: </span>
<span class="l">476: </span>
<span class="l">477: </span>
<span class="l">478: </span>
<span class="l">479: </span>
<span class="l">480: </span>
<span class="l">481: </span>
<span class="l">482: </span>
<span class="l">483: </span>
<span class="l">484: </span>
<span class="l">485: </span>
<span class="l">486: </span>
<span class="l">487: </span>
<span class="l">488: </span>
<span class="l">489: </span>
<span class="l">490: </span>
<span class="l">491: </span>
<span class="l">492: </span>
<span class="l">493: </span>
<span class="l">494: </span>
<span class="l">495: </span>
<span class="l">496: </span>
<span class="l">497: </span>
<span class="l">498: </span>
<span class="l">499: </span>
<span class="l">500: </span>
<span class="l">501: </span>
<span class="l">502: </span>
<span class="l">503: </span>
<span class="l">504: </span>
<span class="l">505: </span>
<span class="l">506: </span>
<span class="l">507: </span>
<span class="l">508: </span>
<span class="l">509: </span>
<span class="l">510: </span>
<span class="l">511: </span>
<span class="l">512: </span>
<span class="l">513: </span>
<span class="l">514: </span>
<span class="l">515: </span>
<span class="l">516: </span>
<span class="l">517: </span>
<span class="l">518: </span>
<span class="l">519: </span>
<span class="l">520: </span>
<span class="l">521: </span>
<span class="l">522: </span>
<span class="l">523: </span>
<span class="l">524: </span>
<span class="l">525: </span>
<span class="l">526: </span>
<span class="l">527: </span>
<span class="l">528: </span>
<span class="l">529: </span>
<span class="l">530: </span>
<span class="l">531: </span>
<span class="l">532: </span>
<span class="l">533: </span>
<span class="l">534: </span>
<span class="l">535: </span>
<span class="l">536: </span>
<span class="l">537: </span>
<span class="l">538: </span>
<span class="l">539: </span>
<span class="l">540: </span>
<span class="l">541: </span>
<span class="l">542: </span>
<span class="l">543: </span>
<span class="l">544: </span>
<span class="l">545: </span>
<span class="l">546: </span>
<span class="l">547: </span>
<span class="l">548: </span>
<span class="l">549: </span>
<span class="l">550: </span>
<span class="l">551: </span>
<span class="l">552: </span>
<span class="l">553: </span>
<span class="l">554: </span>
<span class="l">555: </span>
<span class="l">556: </span>
<span class="l">557: </span>
<span class="l">558: </span>
<span class="l">559: </span>
<span class="l">560: </span>
<span class="l">561: </span>
<span class="l">562: </span>
<span class="l">563: </span>
<span class="l">564: </span>
<span class="l">565: </span>
<span class="l">566: </span>
<span class="l">567: </span>
<span class="l">568: </span>
<span class="l">569: </span>
<span class="l">570: </span>
<span class="l">571: </span>
<span class="l">572: </span>
<span class="l">573: </span>
<span class="l">574: </span>
<span class="l">575: </span>
<span class="l">576: </span>
<span class="l">577: </span>
<span class="l">578: </span>
<span class="l">579: </span>
<span class="l">580: </span>
<span class="l">581: </span>
<span class="l">582: </span>
<span class="l">583: </span>
<span class="l">584: </span>
<span class="l">585: </span>
<span class="l">586: </span>
<span class="l">587: </span>
<span class="l">588: </span>
<span class="l">589: </span>
<span class="l">590: </span>
<span class="l">591: </span>
<span class="l">592: </span>
<span class="l">593: </span>
<span class="l">594: </span>
<span class="l">595: </span>
<span class="l">596: </span>
<span class="l">597: </span>
<span class="l">598: </span>
<span class="l">599: </span>
<span class="l">600: </span>
<span class="l">601: </span>
<span class="l">602: </span>
<span class="l">603: </span>
<span class="l">604: </span>
<span class="l">605: </span>
<span class="l">606: </span>
<span class="l">607: </span>
<span class="l">608: </span>
<span class="l">609: </span>
<span class="l">610: </span>
<span class="l">611: </span>
<span class="l">612: </span>
<span class="l">613: </span>
<span class="l">614: </span>
<span class="l">615: </span>
<span class="l">616: </span>
<span class="l">617: </span>
<span class="l">618: </span>
<span class="l">619: </span>
<span class="l">620: </span>
<span class="l">621: </span>
<span class="l">622: </span>
<span class="l">623: </span>
<span class="l">624: </span>
<span class="l">625: </span>
<span class="l">626: </span>
<span class="l">627: </span>
<span class="l">628: </span>
<span class="l">629: </span>
<span class="l">630: </span>
<span class="l">631: </span>
<span class="l">632: </span>
<span class="l">633: </span>
<span class="l">634: </span>
<span class="l">635: </span>
<span class="l">636: </span>
<span class="l">637: </span>
<span class="l">638: </span>
<span class="l">639: </span>
<span class="l">640: </span>
<span class="l">641: </span>
<span class="l">642: </span>
<span class="l">643: </span>
<span class="l">644: </span>
<span class="l">645: </span>
<span class="l">646: </span>
<span class="l">647: </span>
<span class="l">648: </span>
<span class="l">649: </span>
<span class="l">650: </span>
<span class="l">651: </span>
<span class="l">652: </span>
<span class="l">653: </span>
<span class="l">654: </span>
<span class="l">655: </span>
<span class="l">656: </span>
<span class="l">657: </span>
<span class="l">658: </span>
<span class="l">659: </span>
<span class="l">660: </span>
<span class="l">661: </span>
<span class="l">662: </span>
<span class="l">663: </span>
<span class="l">664: </span>
<span class="l">665: </span>
<span class="l">666: </span>
<span class="l">667: </span>
<span class="l">668: </span>
<span class="l">669: </span>
<span class="l">670: </span>
<span class="l">671: </span>
<span class="l">672: </span>
<span class="l">673: </span>
<span class="l">674: </span>
<span class="l">675: </span>
<span class="l">676: </span>
<span class="l">677: </span>
<span class="l">678: </span>
<span class="l">679: </span>
<span class="l">680: </span>
<span class="l">681: </span>
<span class="l">682: </span>
<span class="l">683: </span>
<span class="l">684: </span>
<span class="l">685: </span>
<span class="l">686: </span>
<span class="l">687: </span>
<span class="l">688: </span>
<span class="l">689: </span>
<span class="l">690: </span>
<span class="l">691: </span>
<span class="l">692: </span>
<span class="l">693: </span>
<span class="l">694: </span>
<span class="l">695: </span>
<span class="l">696: </span>
<span class="l">697: </span>
<span class="l">698: </span>
<span class="l">699: </span>
<span class="l">700: </span>
<span class="l">701: </span>
<span class="l">702: </span>
<span class="l">703: </span>
<span class="l">704: </span>
<span class="l">705: </span>
<span class="l">706: </span>
<span class="l">707: </span>
<span class="l">708: </span>
<span class="l">709: </span>
<span class="l">710: </span>
<span class="l">711: </span>
<span class="l">712: </span>
<span class="l">713: </span>
<span class="l">714: </span>
<span class="l">715: </span>
<span class="l">716: </span>
<span class="l">717: </span>
<span class="l">718: </span>
<span class="l">719: </span>
<span class="l">720: </span>
<span class="l">721: </span>
<span class="l">722: </span>
<span class="l">723: </span>
<span class="l">724: </span>
<span class="l">725: </span>
<span class="l">726: </span>
<span class="l">727: </span>
<span class="l">728: </span>
<span class="l">729: </span>
<span class="l">730: </span>
<span class="l">731: </span>
<span class="l">732: </span>
<span class="l">733: </span>
<span class="l">734: </span>
<span class="l">735: </span>
<span class="l">736: </span>
<span class="l">737: </span>
<span class="l">738: </span>
<span class="l">739: </span>
<span class="l">740: </span>
<span class="l">741: </span>
<span class="l">742: </span>
<span class="l">743: </span>
<span class="l">744: </span>
<span class="l">745: </span>
<span class="l">746: </span>
<span class="l">747: </span>
<span class="l">748: </span>
<span class="l">749: </span>
<span class="l">750: </span>
<span class="l">751: </span>
<span class="l">752: </span>
<span class="l">753: </span>
<span class="l">754: </span>
<span class="l">755: </span>
<span class="l">756: </span>
<span class="l">757: </span>
<span class="l">758: </span>
<span class="l">759: </span>
<span class="l">760: </span>
<span class="l">761: </span>
<span class="l">762: </span>
<span class="l">763: </span>
<span class="l">764: </span>
<span class="l">765: </span>
<span class="l">766: </span>
<span class="l">767: </span>
<span class="l">768: </span>
<span class="l">769: </span>
<span class="l">770: </span>
<span class="l">771: </span>
<span class="l">772: </span>
<span class="l">773: </span>
<span class="l">774: </span>
<span class="l">775: </span>
<span class="l">776: </span>
<span class="l">777: </span>
<span class="l">778: </span>
<span class="l">779: </span>
<span class="l">780: </span>
<span class="l">781: </span>
<span class="l">782: </span>
<span class="l">783: </span>
<span class="l">784: </span>
<span class="l">785: </span>
<span class="l">786: </span>
<span class="l">787: </span>
<span class="l">788: </span>
<span class="l">789: </span>
<span class="l">790: </span>
<span class="l">791: </span>
<span class="l">792: </span>
<span class="l">793: </span>
<span class="l">794: </span>
<span class="l">795: </span>
<span class="l">796: </span>
<span class="l">797: </span>
<span class="l">798: </span>
<span class="l">799: </span>
<span class="l">800: </span>
<span class="l">801: </span>
<span class="l">802: </span>
<span class="l">803: </span>
<span class="l">804: </span>
<span class="l">805: </span>
<span class="l">806: </span>
<span class="l">807: </span>
<span class="l">808: </span>
<span class="l">809: </span>
<span class="l">810: </span>
<span class="l">811: </span>
<span class="l">812: </span>
<span class="l">813: </span>
<span class="l">814: </span>
<span class="l">815: </span>
<span class="l">816: </span>
<span class="l">817: </span>
<span class="l">818: </span>
<span class="l">819: </span>
<span class="l">820: </span>
<span class="l">821: </span>
<span class="l">822: </span>
<span class="l">823: </span>
<span class="l">824: </span>
<span class="l">825: </span>
<span class="l">826: </span>
<span class="l">827: </span>
<span class="l">828: </span>
<span class="l">829: </span>
<span class="l">830: </span>
<span class="l">831: </span>
<span class="l">832: </span>
<span class="l">833: </span>
<span class="l">834: </span>
<span class="l">835: </span>
<span class="l">836: </span>
<span class="l">837: </span>
<span class="l">838: </span>
<span class="l">839: </span>
<span class="l">840: </span>
<span class="l">841: </span>
<span class="l">842: </span>
<span class="l">843: </span>
<span class="l">844: </span>
<span class="l">845: </span>
<span class="l">846: </span>
<span class="l">847: </span>
<span class="l">848: </span>
<span class="l">849: </span>
<span class="l">850: </span>
<span class="l">851: </span>
<span class="l">852: </span>
<span class="l">853: </span>
<span class="l">854: </span>
<span class="l">855: </span>
<span class="l">856: </span>
<span class="l">857: </span>
<span class="l">858: </span>
<span class="l">859: </span>
<span class="l">860: </span>
<span class="l">861: </span>
<span class="l">862: </span>
<span class="l">863: </span>
<span class="l">864: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">System</span>;
<span onmouseout="hideTip(event, 'fs1', 3)" onmouseover="showTip(event, 'fs1', 3)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 4)" onmouseover="showTip(event, 'fs2', 4)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="i">Generic</span>;
<span onmouseout="hideTip(event, 'fs1', 7)" onmouseover="showTip(event, 'fs1', 7)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 8)" onmouseover="showTip(event, 'fs2', 8)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="i">ComponentModel</span>;
<span onmouseout="hideTip(event, 'fs1', 10)" onmouseover="showTip(event, 'fs1', 10)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 11)" onmouseover="showTip(event, 'fs2', 11)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">Data</span>;
<span onmouseout="hideTip(event, 'fs1', 13)" onmouseover="showTip(event, 'fs1', 13)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 14)" onmouseover="showTip(event, 'fs2', 14)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 15)" onmouseover="showTip(event, 'fs7', 15)" class="i">Drawing</span>;
<span onmouseout="hideTip(event, 'fs1', 16)" onmouseover="showTip(event, 'fs1', 16)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 17)" onmouseover="showTip(event, 'fs2', 17)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 18)" onmouseover="showTip(event, 'fs8', 18)" class="i">Linq</span>;
<span onmouseout="hideTip(event, 'fs1', 19)" onmouseover="showTip(event, 'fs1', 19)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 20)" onmouseover="showTip(event, 'fs2', 20)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 21)" onmouseover="showTip(event, 'fs9', 21)" class="i">Text</span>;
<span onmouseout="hideTip(event, 'fs1', 22)" onmouseover="showTip(event, 'fs1', 22)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 23)" onmouseover="showTip(event, 'fs2', 23)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 24)" onmouseover="showTip(event, 'fs10', 24)" class="i">Windows</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 25)" onmouseover="showTip(event, 'fs11', 25)" class="i">Forms</span>;
<span onmouseout="hideTip(event, 'fs1', 26)" onmouseover="showTip(event, 'fs1', 26)" class="i">using</span> <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span>;
<span onmouseout="hideTip(event, 'fs1', 27)" onmouseover="showTip(event, 'fs1', 27)" class="i">using</span> <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">Grouping</span>;
<span onmouseout="hideTip(event, 'fs1', 28)" onmouseover="showTip(event, 'fs1', 28)" class="i">using</span> <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Grouping</span>;
<span onmouseout="hideTip(event, 'fs1', 29)" onmouseover="showTip(event, 'fs1', 29)" class="i">using</span> <span class="i">Syncfusion</span><span class="o">.</span><span class="i">GridHelperClasses</span>;
<span onmouseout="hideTip(event, 'fs1', 30)" onmouseover="showTip(event, 'fs1', 30)" class="i">using</span> <span onmouseout="hideTip(event, 'fs2', 31)" onmouseover="showTip(event, 'fs2', 31)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 32)" onmouseover="showTip(event, 'fs12', 32)" class="i">Configuration</span>;
<span onmouseout="hideTip(event, 'fs1', 33)" onmouseover="showTip(event, 'fs1', 33)" class="i">using</span> <span class="i">DAVEDataInteface</span>;

<span class="k">namespace</span> <span class="i">DaveUI</span>
{
    <span class="k">public</span> <span class="i">partial</span> <span class="k">class</span> <span class="i">Analyzer</span> <span class="o">:</span> <span class="i">Form</span>
    {

        <span class="k">private</span> <span class="i">Dictionary</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 34)" onmouseover="showTip(event, 'fs13', 34)" class="i">string</span>, <span onmouseout="hideTip(event, 'fs13', 35)" onmouseover="showTip(event, 'fs13', 35)" class="i">string</span><span class="o">&gt;</span> <span class="i">expressions</span> <span class="o">=</span> <span class="k">new</span> <span class="i">Dictionary</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 36)" onmouseover="showTip(event, 'fs13', 36)" class="i">string</span>, <span onmouseout="hideTip(event, 'fs13', 37)" onmouseover="showTip(event, 'fs13', 37)" class="i">string</span><span class="o">&gt;</span>();

          
        <span class="i">GridDynamicFilter</span> <span class="i">filter</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GridDynamicFilter</span>();
        <span class="k">private</span> <span class="i">DataTable</span> <span class="i">src</span> <span class="o">=</span> <span class="k">null</span>;
        <span class="k">private</span> <span class="i">DataTable</span> <span class="i">srcCurrent</span> <span class="o">=</span> <span class="k">null</span>;
        <span class="k">private</span> <span class="i">DataTable</span> <span class="i">srcCompare</span> <span class="o">=</span> <span class="k">null</span>;
        <span class="k">private</span> <span class="i">DataTable</span> <span class="i">srcJoined</span> <span class="o">=</span> <span class="k">null</span>; <span class="c">//to store base case joined recordset as joining is expensive.</span>
        <span class="k">private</span> <span class="i">IEnumerable</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 38)" onmouseover="showTip(event, 'fs13', 38)" class="i">string</span><span class="o">&gt;</span> <span class="i">pk_cols</span> <span class="o">=</span> <span class="k">null</span>;
        <span class="k">private</span> <span class="i">IEnumerable</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 39)" onmouseover="showTip(event, 'fs13', 39)" class="i">string</span><span class="o">&gt;</span> <span class="i">diff_cols</span> <span class="o">=</span> <span class="k">null</span>;
        <span class="k">private</span> <span onmouseout="hideTip(event, 'fs13', 40)" onmouseover="showTip(event, 'fs13', 40)" class="i">string</span> <span class="i">currentView</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>;
        <span class="k">private</span> <span onmouseout="hideTip(event, 'fs13', 41)" onmouseover="showTip(event, 'fs13', 41)" class="i">string</span> <span class="i">lastTextSearched</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>;
        

        <span class="k">private</span> <span class="i">GridSummaryRowDescriptor</span> <span class="i">summaryRowDescriptor</span>;
        <span class="k">private</span> <span class="i">GridSummaryRowDescriptor</span> <span class="i">summaryRowDescGrandTotal</span>;
        <span class="k">private</span> <span class="i">GridVisibleColumnDescriptorCollection</span> <span class="i">cachedCols</span>;
        <span class="k">private</span> <span class="i">GridVisibleColumnDescriptorCollection</span> <span class="i">cachedSummaryCols</span>;

        <span class="i">GridOffice2007Filter</span> <span class="i">f2</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GridOffice2007Filter</span>();
        <span class="k">public</span> <span class="i">Analyzer</span>()
        {
            <span class="i">Init</span>();
        }



        <span class="k">public</span> <span class="i">Analyzer</span>(<span class="i">DateTime</span> <span class="i">cob1</span>, <span class="i">DateTime</span> <span class="i">cob2</span>, <span onmouseout="hideTip(event, 'fs13', 42)" onmouseover="showTip(event, 'fs13', 42)" class="i">string</span> <span class="i">datasource</span>, <span onmouseout="hideTip(event, 'fs13', 43)" onmouseover="showTip(event, 'fs13', 43)" class="i">string</span> <span class="i">filter</span>)
        {

            <span class="i">Init</span>();
            <span class="i">dateTimePicker1</span><span class="o">.</span><span class="i">Value</span> <span class="o">=</span> <span class="i">cob1</span>;
            <span class="i">dateTimePicker2</span><span class="o">.</span><span class="i">Value</span> <span class="o">=</span> <span class="i">cob2</span>;
            <span class="i">comboBox1</span><span class="o">.</span><span class="i">Text</span> <span class="o">=</span> <span class="i">datasource</span>;
            <span class="i">LoadAndApply</span>(<span class="i">datasource</span>, <span class="i">filter</span>);
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">Init</span>()
        {

            <span class="i">InitializeComponent</span>();
            <span class="i">checkBox2_CheckedChanged</span>(<span class="i">this</span>, <span class="k">null</span>);
            <span class="i">FormatGrid</span>(<span class="i">grid</span>);
            <span class="i">SetupSummaryRows</span>();
            <span class="i">comboBox1</span><span class="o">.</span><span class="i">Items</span><span class="o">.</span><span class="i">Clear</span>();
            <span class="i">comboBox1</span><span class="o">.</span><span class="i">Items</span><span class="o">.</span><span class="i">AddRange</span>(<span class="i">Controller</span><span class="o">.</span><span class="i">GetSources</span>());
            <span class="i">OptimizeGrid</span>(<span class="i">grid</span>);
         
            <span class="i">comboBox1</span><span class="o">.</span><span class="i">SelectedItem</span> <span class="o">=</span> <span class="i">comboBox1</span><span class="o">.</span><span class="i">Items</span>[<span class="n">0</span>];
            <span class="i">grid</span><span class="o">.</span><span class="i">TableOptions</span><span class="o">.</span><span class="i">AllowSelection</span> <span class="o">=</span> ((<span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span>)(((((((<span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Row</span> | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Cell</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Multiple</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Shift</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Keyboard</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">AlphaBlend</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">MixRangeType</span>)));
        }
        <span class="k">void</span> <span class="i">grid_TableControlCellDoubleClick</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">GridTableControlCellClickEventArgs</span> <span class="i">e</span>)
        {

        }


        <span class="k">public</span> <span class="k">void</span> <span class="i">FixStringColumnErrors</span>(<span class="i">DataTable</span> <span class="i">dt</span>, <span onmouseout="hideTip(event, 'fs13', 44)" onmouseover="showTip(event, 'fs13', 44)" class="i">string</span>[] <span class="i">summarycols</span>)
        {
            <span class="i">var</span> <span class="i">summarydiffcols</span> <span class="o">=</span> <span class="i">summarycols</span><span class="o">.</span><span class="i">Concat</span>(<span class="i">diff_cols</span>);
            <span class="i">foreach</span> (<span onmouseout="hideTip(event, 'fs13', 45)" onmouseover="showTip(event, 'fs13', 45)" class="i">string</span> <span class="i">colstring</span> <span class="k">in</span> <span class="i">summarydiffcols</span>)
            {
                <span class="k">if</span> (<span class="i">dt</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">colstring</span>]<span class="o">.</span><span class="i">DataType</span> <span class="o">==</span> <span onmouseout="hideTip(event, 'fs14', 46)" onmouseover="showTip(event, 'fs14', 46)" class="i">typeof</span>(<span onmouseout="hideTip(event, 'fs13', 47)" onmouseover="showTip(event, 'fs13', 47)" class="i">string</span>))
                {
                    <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span><span class="o">.</span><span class="i">Add</span>(<span class="i">colstring</span> <span class="o">+</span> <span class="s">&quot;TEMP&quot;</span>, <span onmouseout="hideTip(event, 'fs14', 48)" onmouseover="showTip(event, 'fs14', 48)" class="i">typeof</span>(<span onmouseout="hideTip(event, 'fs15', 49)" onmouseover="showTip(event, 'fs15', 49)" class="i">float</span>));

                    <span class="i">foreach</span> (<span class="i">DataRow</span> <span class="i">dr</span> <span class="k">in</span> <span class="i">dt</span><span class="o">.</span><span class="i">Rows</span>)
                    {

                        <span class="k">if</span> (<span class="i">dr</span>[<span class="i">colstring</span>] <span class="o">==</span> <span class="i">DBNull</span><span class="o">.</span><span class="i">Value</span> <span class="o">||</span> <span class="i">dr</span>[<span class="i">colstring</span>]<span class="o">.</span><span class="i">ToString</span>() <span class="o">==</span> <span class="s">&quot;&quot;</span>)
                        {
                            <span class="i">dr</span>[<span class="i">colstring</span> <span class="o">+</span> <span class="s">&quot;TEMP&quot;</span>] <span class="o">=</span> <span class="i">DBNull</span><span class="o">.</span><span class="i">Value</span>;
                        }
                        <span class="k">else</span>
                        {
                            <span class="i">dr</span>[<span class="i">colstring</span> <span class="o">+</span> <span class="s">&quot;TEMP&quot;</span>] <span class="o">=</span>  <span class="i">Double</span><span class="o">.</span><span class="i">Parse</span>(<span class="i">dr</span>[<span class="i">colstring</span>]<span class="o">.</span><span class="i">ToString</span>());
                        }
<span class="c">//                        dr[colstring + &quot;TEMP&quot;] = dr[colstring] == DBNull.Value ? dr[colstring] : Double.Parse(dr[colstring].ToString());</span>

                    }

                    <span class="i">var</span> <span class="i">colPosition</span> <span class="o">=</span> <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">colstring</span>]<span class="o">.</span><span class="i">Ordinal</span>;
                    <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span><span class="o">.</span><span class="i">Remove</span>(<span class="i">colstring</span>);

                    <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">colstring</span> <span class="o">+</span> <span class="s">&quot;TEMP&quot;</span>]<span class="o">.</span><span class="i">ColumnName</span> <span class="o">=</span> <span class="i">colstring</span>;
                    <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">colstring</span>]<span class="o">.</span><span class="i">SetOrdinal</span>(<span class="i">colPosition</span>);
                }
            }
        }

        <span class="k">public</span> <span class="k">void</span> <span class="i">LoadAndApply</span>(<span onmouseout="hideTip(event, 'fs13', 50)" onmouseover="showTip(event, 'fs13', 50)" class="i">string</span> <span class="i">datasource</span>, <span onmouseout="hideTip(event, 'fs13', 51)" onmouseover="showTip(event, 'fs13', 51)" class="i">string</span> <span class="i">filter</span>)
        {
            <span class="i">cachedCols</span> <span class="o">=</span> <span class="k">null</span>;
            <span class="i">cachedSummaryCols</span> <span class="o">=</span> <span class="k">null</span>;

            <span onmouseout="hideTip(event, 'fs2', 52)" onmouseover="showTip(event, 'fs2', 52)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 53)" onmouseover="showTip(event, 'fs16', 53)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 54)" onmouseover="showTip(event, 'fs17', 54)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 55)" onmouseover="showTip(event, 'fs18', 55)" class="i">WriteLine</span>(<span class="s">&quot;load and apply: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 56)" onmouseover="showTip(event, 'fs2', 56)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 57)" onmouseover="showTip(event, 'fs19', 57)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 58)" onmouseover="showTip(event, 'fs20', 58)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 59)" onmouseover="showTip(event, 'fs21', 59)" class="i">ToLongTimeString</span>());
            <span class="i">var</span> <span class="i">summarycols</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetList</span>(<span class="i">datasource</span>, <span class="s">&quot;SummaryFields&quot;</span>);
            <span class="i">pk_cols</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetList</span>(<span class="i">datasource</span>, <span class="s">&quot;PK_COLUMNS&quot;</span>)<span class="o">.</span><span class="i">AsEnumerable</span>();
            <span class="i">diff_cols</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetList</span>(<span class="i">datasource</span>, <span class="s">&quot;DIFF_COLUMNS&quot;</span>)<span class="o">.</span><span class="i">AsEnumerable</span>();
            <span class="i">var</span> <span class="i">groupcols</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetList</span>(<span class="i">datasource</span>, <span class="s">&quot;DefaultGroupingFields&quot;</span>);

            <span class="i">IDaveData</span> <span class="i">handler</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetHandler</span>(<span class="i">datasource</span>); <span class="c">//Activator.CreateInstance(myType) as IDaveData;</span>
            <span class="i">var</span> <span class="i">param</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetParameters</span>(<span class="i">datasource</span>);
            <span class="i">param</span><span class="o">.</span><span class="i">Add</span>(<span class="s">&quot;COB&quot;</span>, <span class="i">dateTimePicker1</span><span class="o">.</span><span class="i">Value</span>);

            <span class="k">try</span>
            {
                <span class="i">srcCurrent</span> <span class="o">=</span> <span class="i">handler</span><span class="o">.</span><span class="i">GetData</span>(<span class="i">param</span>);
            }
            <span class="i">catch</span> (<span class="i">Exception</span> <span class="i">e</span>)
            {
                <span class="i">MessageBox</span><span class="o">.</span><span class="i">Show</span>(<span class="i">e</span><span class="o">.</span><span class="i">ToString</span>());
                <span class="k">return</span>;
            }

            <span class="i">var</span> <span class="i">summarydiffcols</span> <span class="o">=</span> <span class="i">summarycols</span><span class="o">.</span><span class="i">Concat</span>( <span class="i">diff_cols</span>);
            <span class="i">FixStringColumnErrors</span>(<span class="i">srcCurrent</span>,<span class="i">summarycols</span>);


            <span class="i">src</span> <span class="o">=</span> <span class="i">srcCurrent</span>;
            <span class="k">if</span> (<span class="i">checkBox2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 60)" onmouseover="showTip(event, 'fs22', 60)" class="i">Checked</span>)
            {
                <span class="i">param</span>[<span class="s">&quot;COB&quot;</span>] <span class="o">=</span> <span class="i">dateTimePicker2</span><span class="o">.</span><span class="i">Value</span>;
                <span class="i">srcCompare</span> <span class="o">=</span> <span class="i">handler</span><span class="o">.</span><span class="i">GetData</span>(<span class="i">param</span>);
                <span class="i">FixStringColumnErrors</span>(<span class="i">srcCompare</span>, <span class="i">summarycols</span>);
                <span class="c">//remove duplicates before joining</span>
                <span class="i">var</span> <span class="i">pk_list</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs23', 61)" onmouseover="showTip(event, 'fs23', 61)" class="i">List</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 62)" onmouseover="showTip(event, 'fs13', 62)" class="i">string</span><span class="o">&gt;</span>(<span class="i">pk_cols</span>);
                <span onmouseout="hideTip(event, 'fs2', 63)" onmouseover="showTip(event, 'fs2', 63)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 64)" onmouseover="showTip(event, 'fs16', 64)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 65)" onmouseover="showTip(event, 'fs17', 65)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 66)" onmouseover="showTip(event, 'fs18', 66)" class="i">WriteLine</span>(<span class="s">&quot;before cleanup: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 67)" onmouseover="showTip(event, 'fs2', 67)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 68)" onmouseover="showTip(event, 'fs19', 68)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 69)" onmouseover="showTip(event, 'fs20', 69)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 70)" onmouseover="showTip(event, 'fs21', 70)" class="i">ToLongTimeString</span>());
                <span class="i">RemoveDuplicatesFromDataTable</span>(<span onmouseout="hideTip(event, 'fs24', 71)" onmouseover="showTip(event, 'fs24', 71)" class="i">ref</span> <span class="i">srcCurrent</span>, <span class="i">pk_list</span>);
                <span onmouseout="hideTip(event, 'fs2', 72)" onmouseover="showTip(event, 'fs2', 72)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 73)" onmouseover="showTip(event, 'fs16', 73)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 74)" onmouseover="showTip(event, 'fs17', 74)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 75)" onmouseover="showTip(event, 'fs18', 75)" class="i">WriteLine</span>(<span class="s">&quot;after cleanup 1: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 76)" onmouseover="showTip(event, 'fs2', 76)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 77)" onmouseover="showTip(event, 'fs19', 77)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 78)" onmouseover="showTip(event, 'fs20', 78)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 79)" onmouseover="showTip(event, 'fs21', 79)" class="i">ToLongTimeString</span>());
                <span class="i">RemoveDuplicatesFromDataTable</span>(<span onmouseout="hideTip(event, 'fs24', 80)" onmouseover="showTip(event, 'fs24', 80)" class="i">ref</span> <span class="i">srcCompare</span>, <span class="i">pk_list</span>);
                <span onmouseout="hideTip(event, 'fs2', 81)" onmouseover="showTip(event, 'fs2', 81)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 82)" onmouseover="showTip(event, 'fs16', 82)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 83)" onmouseover="showTip(event, 'fs17', 83)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 84)" onmouseover="showTip(event, 'fs18', 84)" class="i">WriteLine</span>(<span class="s">&quot;after cleanup 2: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 85)" onmouseover="showTip(event, 'fs2', 85)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 86)" onmouseover="showTip(event, 'fs19', 86)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 87)" onmouseover="showTip(event, 'fs20', 87)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 88)" onmouseover="showTip(event, 'fs21', 88)" class="i">ToLongTimeString</span>());

                <span class="i">src</span> <span class="o">=</span> <span class="i">Utility</span><span class="o">.</span><span class="i">MergeTables</span>(<span class="i">srcCurrent</span>, <span class="i">srcCompare</span>, <span class="i">pk_cols</span>, <span class="i">diff_cols</span>);

                <span onmouseout="hideTip(event, 'fs2', 89)" onmouseover="showTip(event, 'fs2', 89)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 90)" onmouseover="showTip(event, 'fs16', 90)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 91)" onmouseover="showTip(event, 'fs17', 91)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 92)" onmouseover="showTip(event, 'fs18', 92)" class="i">WriteLine</span>(<span class="s">&quot;after merge: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 93)" onmouseover="showTip(event, 'fs2', 93)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 94)" onmouseover="showTip(event, 'fs19', 94)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 95)" onmouseover="showTip(event, 'fs20', 95)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 96)" onmouseover="showTip(event, 'fs21', 96)" class="i">ToLongTimeString</span>());
            }

            <span class="i">grid</span><span class="o">.</span><span class="i">DataSource</span> <span class="o">=</span> <span class="i">src</span>;<span class="c">// handler.GetData(param);</span>
            <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span><span class="o">.</span><span class="i">Reset</span>();

            <span onmouseout="hideTip(event, 'fs2', 97)" onmouseover="showTip(event, 'fs2', 97)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 98)" onmouseover="showTip(event, 'fs16', 98)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 99)" onmouseover="showTip(event, 'fs17', 99)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 100)" onmouseover="showTip(event, 'fs18', 100)" class="i">WriteLine</span>(<span class="s">&quot;step 1: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 101)" onmouseover="showTip(event, 'fs2', 101)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 102)" onmouseover="showTip(event, 'fs19', 102)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 103)" onmouseover="showTip(event, 'fs20', 103)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 104)" onmouseover="showTip(event, 'fs21', 104)" class="i">ToLongTimeString</span>());

            <span class="i">foreach</span> (<span class="i">var</span> <span class="i">col</span> <span class="k">in</span> <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>)
            {
                <span class="i">var</span> <span class="i">format</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetFieldAttribute</span>(<span class="i">datasource</span>, <span class="s">&quot;CustomFormats&quot;</span>, <span class="i">col</span><span class="o">.</span><span class="i">Name</span>, <span class="s">&quot;Format&quot;</span>);

                <span class="c">//for prev and diff columns, use the format of the main column</span>
                <span class="k">if</span> (<span class="i">col</span><span class="o">.</span><span class="i">Name</span><span class="o">.</span><span class="i">Contains</span>(<span class="s">&quot;_DIFF&quot;</span>) <span class="o">||</span> <span class="i">col</span><span class="o">.</span><span class="i">Name</span><span class="o">.</span><span class="i">Contains</span>(<span class="s">&quot;_PREV&quot;</span>))
                {
                    <span class="i">format</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetFieldAttribute</span>(<span class="i">datasource</span>, <span class="s">&quot;CustomFormats&quot;</span>, <span class="i">col</span><span class="o">.</span><span class="i">Name</span><span class="o">.</span><span class="i">Replace</span>(<span class="s">&quot;_PREV&quot;</span>, <span class="s">&quot;&quot;</span>)<span class="o">.</span><span class="i">Replace</span>(<span class="s">&quot;_DIFF&quot;</span>, <span class="s">&quot;&quot;</span>), <span class="s">&quot;Format&quot;</span>);
                }
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">col</span><span class="o">.</span><span class="i">Name</span>]<span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyRecordFieldCell</span><span class="o">.</span><span class="i">CellType</span> <span class="o">=</span> <span class="s">&quot;Static&quot;</span>;
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">col</span><span class="o">.</span><span class="i">Name</span>]<span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyRecordFieldCell</span><span class="o">.</span><span class="i">ReadOnly</span> <span class="o">=</span> <span class="k">true</span>;
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">col</span><span class="o">.</span><span class="i">Name</span>]<span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyRecordFieldCell</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 105)" onmouseover="showTip(event, 'fs25', 105)" class="i">Format</span> <span class="o">=</span> <span class="i">format</span>;

            }

            <span class="c">//create a list of all the columns that need to be summarized</span>

            <span class="i">var</span> <span class="i">l</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs23', 106)" onmouseover="showTip(event, 'fs23', 106)" class="i">List</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 107)" onmouseover="showTip(event, 'fs13', 107)" class="i">string</span><span class="o">&gt;</span>();

            <span class="i">foreach</span> (<span class="i">var</span> <span class="i">i</span> <span class="k">in</span> <span class="i">summarycols</span>)
            {
                <span class="i">l</span><span class="o">.</span><span class="i">Add</span>(<span class="i">i</span>);
                <span class="k">if</span> (<span class="i">diff_cols</span><span class="o">.</span><span class="i">Contains</span>(<span class="i">i</span>))
                {
                    <span class="i">l</span><span class="o">.</span><span class="i">Add</span>(<span class="i">i</span> <span class="o">+</span> <span class="s">&quot;_DIFF&quot;</span>);
                    <span class="i">l</span><span class="o">.</span><span class="i">Add</span>(<span class="i">i</span> <span class="o">+</span> <span class="s">&quot;_PREV&quot;</span>);
                }
            }

            <span class="k">if</span> (<span class="i">l</span><span class="o">.</span><span class="i">Count</span>() <span class="o">&gt;</span> <span class="n">0</span>)
                <span class="i">AddSummaryCols</span>(<span class="i">l</span><span class="o">.</span><span class="i">ToArray</span>());

            <span class="i">foreach</span> (<span class="i">var</span> <span class="i">item</span> <span class="k">in</span> <span class="i">groupcols</span>)
            {
                <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">GroupedColumns</span><span class="o">.</span><span class="i">Add</span>(<span class="i">item</span>);
            }


            <span class="c">//for (int i = 0; i &lt; grid.TableDescriptor.Columns.Count; i++)</span>
            <span class="c">//    grid.TableDescriptor.Columns[i].AllowFilter = true;</span>

            <span class="i">grid</span><span class="o">.</span><span class="i">TopLevelGroupOptions</span><span class="o">.</span><span class="i">ShowFilterBar</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="c">//filter.WireGrid(grid);</span>

            <span class="c">//f2.WireGrid(grid);</span>

            <span onmouseout="hideTip(event, 'fs2', 108)" onmouseover="showTip(event, 'fs2', 108)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 109)" onmouseover="showTip(event, 'fs16', 109)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 110)" onmouseover="showTip(event, 'fs17', 110)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 111)" onmouseover="showTip(event, 'fs18', 111)" class="i">WriteLine</span>(<span class="s">&quot;step 10: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 112)" onmouseover="showTip(event, 'fs2', 112)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 113)" onmouseover="showTip(event, 'fs19', 113)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 114)" onmouseover="showTip(event, 'fs20', 114)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 115)" onmouseover="showTip(event, 'fs21', 115)" class="i">ToLongTimeString</span>());

        }


        <span class="k">public</span> <span class="k">void</span> <span class="i">Find</span>()
        {
            <span class="i">IGridFindReplaceDialogSink</span> <span class="i">dialogSink</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GroupingGridFindReplaceDialogSink</span>(<span class="i">grid</span>);
            <span class="i">GridFindReplaceDialog</span> <span class="i">dialog</span> <span class="o">=</span> <span class="i">GridFindReplaceDialog</span><span class="o">.</span><span class="i">Instance</span>;
            <span class="i">dialog</span><span class="o">.</span><span class="i">Text</span> <span class="o">=</span> <span class="s">&quot;Find&quot;</span>;
            <span class="i">dialog</span><span class="o">.</span><span class="i">Owner</span> <span class="o">=</span> <span class="i">this</span>;
            <span class="i">dialog</span><span class="o">.</span><span class="i">SetState</span>(<span class="i">dialogSink</span>, <span class="i">lastTextSearched</span>, <span class="k">false</span>);
            <span class="i">dialog</span><span class="o">.</span><span class="i">ShowInTaskbar</span> <span class="o">=</span> <span class="k">false</span>;
            <span class="i">dialog</span><span class="o">.</span><span class="i">ShowReplaceButton</span> <span class="o">=</span> <span class="k">false</span>;
            <span class="i">dialog</span><span class="o">.</span><span class="i">ShowDialog</span>();
            <span class="i">lastTextSearched</span> <span class="o">=</span> <span class="i">dialog</span><span class="o">.</span><span class="i">TextSearched</span>;
        }


        <span class="k">private</span> <span class="k">class</span> <span class="i">GroupingGridFindReplaceDialogSink</span> <span class="o">:</span> <span class="i">IGridFindReplaceDialogSink</span>
        {
            <span class="k">private</span> <span class="i">GridGroupingControl</span> <span class="i">grid</span>;
            <span class="k">private</span> <span onmouseout="hideTip(event, 'fs26', 116)" onmouseover="showTip(event, 'fs26', 116)" class="i">int</span> <span class="i">lastRowIndex</span> <span class="o">=</span> <span class="n">0</span>, <span class="i">lastColIndex</span> <span class="o">=</span> <span class="n">0</span>;
            <span class="k">public</span> <span class="i">GroupingGridFindReplaceDialogSink</span>(<span class="i">GridGroupingControl</span> <span class="i">grid</span>)
            {
                <span class="i">this</span><span class="o">.</span><span class="i">grid</span> <span class="o">=</span> <span class="i">grid</span>;
            }

            # <span class="i">IGridFindReplaceDialogSink</span> <span class="i">Members</span>

            <span class="k">public</span> <span class="i">object</span> <span class="i">Find</span>(<span class="i">GridFindReplaceEventArgs</span> <span class="i">e</span>)
            {
                <span onmouseout="hideTip(event, 'fs26', 117)" onmouseover="showTip(event, 'fs26', 117)" class="i">int</span> <span class="i">startRowIndex</span> <span class="o">=</span> <span class="n">0</span>, <span class="i">startColIndex</span> <span class="o">=</span> <span class="n">0</span>, <span class="i">finalColIndex</span> <span class="o">=</span> <span class="n">0</span>;
                <span class="i">DataView</span> <span class="i">dv</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">GetCurrencyManager</span>()<span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 118)" onmouseover="showTip(event, 'fs23', 118)" class="i">List</span> <span class="k">as</span> <span class="i">DataView</span>;
                <span class="i">DataTable</span> <span class="i">dt</span> <span class="o">=</span> <span class="i">dv</span><span class="o">.</span><span class="i">Table</span>;
                <span class="k">if</span> ((<span class="i">e</span><span class="o">.</span><span class="i">Options</span> <span class="o">&amp;</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">WholeTable</span>) <span class="o">==</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">WholeTable</span>)
                {
                    <span class="i">finalColIndex</span> <span class="o">=</span> <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span><span class="o">.</span><span class="i">Count</span>;
                    <span class="k">if</span> (<span class="i">e</span><span class="o">.</span><span class="i">LocationInfo</span> <span class="o">!=</span> <span class="k">null</span>)
                    {	<span class="c">//not first iteration, but 2 or succeding iteration</span>
                        <span class="i">startRowIndex</span> <span class="o">=</span> <span class="i">lastRowIndex</span>; <span class="c">//((GridRangeInfo)e.LocationInfo).Top;</span>
                        <span class="i">startColIndex</span> <span class="o">=</span> <span class="i">lastColIndex</span> <span class="o">+</span> <span class="n">1</span>; <span class="c">//((GridRangeInfo)e.LocationInfo).Left + 1;</span>
                    }
                    <span class="i">startColIndex</span> <span class="o">%=</span> <span class="i">finalColIndex</span>;
                }
                <span class="k">else</span> <span class="k">if</span> ((<span class="i">e</span><span class="o">.</span><span class="i">Options</span> <span class="o">&amp;</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">ColumnOnly</span>) <span class="o">==</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">ColumnOnly</span>)
                {
                    <span class="k">if</span> (<span class="i">e</span><span class="o">.</span><span class="i">LocationInfo</span> <span class="o">!=</span> <span class="k">null</span>)	<span class="c">//not first iteration, but 2 or succeding iteration</span>
                        <span class="i">startRowIndex</span> <span class="o">=</span> <span class="i">lastRowIndex</span> <span class="o">+</span> <span class="n">1</span>;	<span class="c">//start at next row</span>
                    <span class="i">FieldDescriptor</span> <span class="i">currentFieldDescriptor</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">CurrentRecordManager</span><span class="o">.</span><span class="i">CurrentField</span>;
                    <span class="k">if</span> (<span class="i">currentFieldDescriptor</span> <span class="o">==</span> <span class="k">null</span>)
                        <span class="k">return</span> <span class="k">null</span>;
                    <span onmouseout="hideTip(event, 'fs13', 119)" onmouseover="showTip(event, 'fs13', 119)" class="i">string</span> <span class="i">currentColName</span> <span class="o">=</span> <span class="i">currentFieldDescriptor</span><span class="o">.</span><span class="i">Name</span>;
                    <span class="i">startColIndex</span> <span class="o">=</span> <span class="i">dt</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">currentColName</span>]<span class="o">.</span><span class="i">Ordinal</span>;
                    <span class="i">finalColIndex</span> <span class="o">=</span> <span class="i">startColIndex</span> <span class="o">+</span> <span class="n">1</span>;
                }

                <span class="k">for</span> (<span onmouseout="hideTip(event, 'fs26', 120)" onmouseover="showTip(event, 'fs26', 120)" class="i">int</span> <span class="i">rowIndex</span> <span class="o">=</span> <span class="i">startRowIndex</span>; <span class="i">rowIndex</span> <span class="o">&lt;</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">Records</span><span class="o">.</span><span class="i">Count</span>; <span class="i">rowIndex</span><span class="o">++</span>)
                {
                    <span class="i">Record</span> <span class="k">rec</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">Records</span>[<span class="i">rowIndex</span>];
                    <span class="i">DataRowView</span> <span class="i">rv</span> <span class="o">=</span> (<span class="i">DataRowView</span>)<span class="k">rec</span><span class="o">.</span><span class="i">GetData</span>();
                    <span class="k">for</span> (<span onmouseout="hideTip(event, 'fs26', 121)" onmouseover="showTip(event, 'fs26', 121)" class="i">int</span> <span class="i">colIndex</span> <span class="o">=</span> <span class="i">startColIndex</span>; <span class="i">colIndex</span> <span class="o">&lt;</span> <span class="i">finalColIndex</span>; <span class="i">colIndex</span><span class="o">++</span>)
                    {
                        <span onmouseout="hideTip(event, 'fs13', 122)" onmouseover="showTip(event, 'fs13', 122)" class="i">string</span> <span class="i">columnText</span> <span class="o">=</span> <span class="i">rv</span>[<span class="i">colIndex</span>]<span class="o">.</span><span class="i">ToString</span>();
                        <span class="k">if</span> (<span class="i">Find</span>(<span class="i">columnText</span>, <span class="i">e</span><span class="o">.</span><span class="i">FindString</span>, <span class="i">e</span><span class="o">.</span><span class="i">Options</span>))
                        {
                            <span onmouseout="hideTip(event, 'fs13', 123)" onmouseover="showTip(event, 'fs13', 123)" class="i">string</span> <span class="i">columnName</span> <span class="o">=</span> <span class="i">rv</span><span class="o">.</span><span class="i">DataView</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">colIndex</span>]<span class="o">.</span><span class="i">ColumnName</span>;
                            <span class="k">rec</span><span class="o">.</span><span class="i">SetCurrent</span>(<span class="i">columnName</span>);
                            <span class="i">lastRowIndex</span> <span class="o">=</span> <span class="i">rowIndex</span>;
                            <span class="i">lastColIndex</span> <span class="o">=</span> <span class="i">colIndex</span>;
                            <span class="k">return</span> <span class="i">GridRangeInfo</span><span class="o">.</span><span class="i">Cell</span>(<span class="i">rowIndex</span>, <span class="i">colIndex</span>);
                        }
                    }
                    <span class="k">if</span> ((<span class="i">e</span><span class="o">.</span><span class="i">Options</span> <span class="o">&amp;</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">WholeTable</span>) <span class="o">==</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">WholeTable</span>)
                        <span class="i">startColIndex</span> <span class="o">=</span> <span class="n">0</span>;
                }
                <span class="k">return</span> <span class="k">null</span>;
            }
            <span class="k">private</span> <span onmouseout="hideTip(event, 'fs27', 124)" onmouseover="showTip(event, 'fs27', 124)" class="i">bool</span> <span class="i">Find</span>(<span onmouseout="hideTip(event, 'fs13', 125)" onmouseover="showTip(event, 'fs13', 125)" class="i">string</span> <span class="i">source</span>, <span onmouseout="hideTip(event, 'fs13', 126)" onmouseover="showTip(event, 'fs13', 126)" class="i">string</span> <span class="i">searchedText</span>, <span class="i">GridFindTextOptions</span> <span class="i">options</span>)
            {
                <span class="k">if</span> ((<span class="i">options</span> <span class="o">&amp;</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">MatchWholeCell</span>) <span class="o">==</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">MatchWholeCell</span>)
                    <span class="k">if</span> ((<span class="i">options</span> <span class="o">&amp;</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">MatchCase</span>) <span class="o">==</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">MatchCase</span>)
                        <span class="k">return</span> (<span class="i">source</span> <span class="o">==</span> <span class="i">searchedText</span>);
                    <span class="k">else</span>
                        <span class="k">return</span> (<span class="i">source</span><span class="o">.</span><span class="i">ToUpper</span>() <span class="o">==</span> <span class="i">searchedText</span><span class="o">.</span><span class="i">ToUpper</span>());
                <span class="k">else</span>
                    <span class="k">if</span> ((<span class="i">options</span> <span class="o">&amp;</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">MatchCase</span>) <span class="o">==</span> <span class="i">GridFindTextOptions</span><span class="o">.</span><span class="i">MatchCase</span>)
                        <span class="k">return</span> (<span class="i">source</span><span class="o">.</span><span class="i">IndexOf</span>(<span class="i">searchedText</span>) <span class="o">&gt;</span> <span class="o">-</span><span class="n">1</span>);
                    <span class="k">else</span>
                        <span class="k">return</span> (<span class="i">source</span><span class="o">.</span><span class="i">ToUpper</span>()<span class="o">.</span><span class="i">IndexOf</span>(<span class="i">searchedText</span><span class="o">.</span><span class="i">ToUpper</span>()) <span class="o">&gt;</span> <span class="o">-</span><span class="n">1</span>);
            }

            <span class="k">public</span> <span class="k">void</span> <span class="i">ReplaceAll</span>(<span class="i">GridFindReplaceEventArgs</span> <span class="i">e</span>)
            {
                <span class="c">// TODO:  Add f.ReplaceAll implementation</span>
            }

            <span class="k">public</span> <span class="i">object</span> <span class="i">Replace</span>(<span class="i">GridFindReplaceEventArgs</span> <span class="i">e</span>)
            {
                <span class="c">// TODO:  Add f.Replace implementation</span>
                <span class="k">return</span> <span class="k">null</span>;
            }

            <span class="k">public</span> <span class="i">Rectangle</span> <span class="i">GetScreenRect</span>(<span class="i">object</span> <span class="i">lc</span>)
            {
                <span class="c">// TODO:  Add f.GetScreenRect implementation</span>
                <span class="k">return</span> <span class="k">new</span> <span class="i">Rectangle</span>();
            }

            <span class="k">public</span> <span class="k">void</span> <span class="i">ShowInfoMessage</span>(<span onmouseout="hideTip(event, 'fs13', 127)" onmouseover="showTip(event, 'fs13', 127)" class="i">string</span> <span class="i">msg</span>, <span onmouseout="hideTip(event, 'fs13', 128)" onmouseover="showTip(event, 'fs13', 128)" class="i">string</span> <span class="i">category</span>)
            {
                <span class="i">MessageBox</span><span class="o">.</span><span class="i">Show</span>(<span class="i">msg</span>, <span class="i">category</span>);
                <span class="c">// TODO:  Add f.ShowInfoMessage implementation</span>
            }

            #

        }



        <span class="k">public</span> <span class="k">void</span> <span class="i">FormatGrid</span>(<span class="i">GridGroupingControl</span> <span class="i">grid</span>)
        {


            <span class="i">GridTableDescriptor</span> <span class="i">desc</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span>;
            <span class="i">desc</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">ShowCaptionSummaryCells</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="i">desc</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionSummaryRow</span> <span class="o">=</span> <span class="s">&quot;MyCaption&quot;</span>;

            <span class="i">desc</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionText</span> <span class="o">=</span> <span class="s">&quot;{Category} ({RecordCount})&quot;</span>;

            <span class="i">desc</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">ShowSummaries</span> <span class="o">=</span> <span class="k">false</span>;
            <span class="i">desc</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">ShowAddNewRecordBeforeDetails</span> <span class="o">=</span> <span class="k">false</span>;

            <span class="i">desc</span><span class="o">.</span><span class="i">TopLevelGroupOptions</span><span class="o">.</span><span class="i">ShowAddNewRecordBeforeDetails</span> <span class="o">=</span> <span class="k">false</span>;

            <span class="c">//grid.Appearance.AnyCell.CellType = &quot;Static&quot;;</span>
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span class="i">Font</span><span class="o">.</span><span class="i">Facename</span> <span class="o">=</span> <span class="s">&quot;Calibri&quot;</span>;


            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionCell</span><span class="o">.</span><span class="i">BackColor</span> <span class="o">=</span> <span class="i">Color</span><span class="o">.</span><span class="i">FromArgb</span>(<span class="n">246</span>, <span class="n">244</span>, <span class="n">233</span>);
            <span class="c">//grid.Appearance.GroupCaptionCell.TextColor = Color.WhiteSmoke;</span>
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionCell</span><span class="o">.</span><span class="i">Font</span><span class="o">.</span><span class="i">Bold</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="c">//grid.Appearance.GroupCaptionCell.Font.Facename = &quot;Courier New&quot;;</span>


            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionCell</span><span class="o">.</span><span class="i">Borders</span><span class="o">.</span><span class="i">Top</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GridBorder</span>(<span class="i">GridBorderStyle</span><span class="o">.</span><span class="i">Standard</span>);
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionCell</span><span class="o">.</span><span class="i">CellType</span> <span class="o">=</span> <span class="s">&quot;Static&quot;</span>;
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionSummaryCell</span><span class="o">.</span><span class="i">BackColor</span> <span class="o">=</span> <span class="i">Color</span><span class="o">.</span><span class="i">FromArgb</span>(<span class="n">246</span>, <span class="n">244</span>, <span class="n">233</span>);
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionSummaryCell</span><span class="o">.</span><span class="i">Font</span><span class="o">.</span><span class="i">Facename</span> <span class="o">=</span> <span class="s">&quot;Calibri&quot;</span>;
           <span class="c">// grid.Appearance.GroupCaptionSummaryCell.TextColor = Color.WhiteSmoke;</span>

            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionSummaryCell</span><span class="o">.</span><span class="i">CellValueType</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs14', 129)" onmouseover="showTip(event, 'fs14', 129)" class="i">typeof</span>(<span onmouseout="hideTip(event, 'fs28', 130)" onmouseover="showTip(event, 'fs28', 130)" class="i">decimal</span>);
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionSummaryCell</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 131)" onmouseover="showTip(event, 'fs25', 131)" class="i">Format</span> <span class="o">=</span> <span class="s">&quot;#,##0_);[Red](#,##0)&quot;</span>;<span class="c">//&quot;#,##0.00;(#,##0.00);-&quot;;</span>
            <span class="i">grid</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">GroupCaptionSummaryCell</span><span class="o">.</span><span class="i">Font</span><span class="o">.</span><span class="i">Bold</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="i">grid</span><span class="o">.</span><span class="i">TableOptions</span><span class="o">.</span><span class="i">AllowSelection</span> <span class="o">=</span> ((<span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span>)(((((((<span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Row</span> | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Cell</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Multiple</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Shift</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">Keyboard</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">AlphaBlend</span>)
                | <span class="i">Syncfusion</span><span class="o">.</span><span class="i">Windows</span><span class="o">.</span><span class="i">Forms</span><span class="o">.</span><span class="i">Grid</span><span class="o">.</span><span class="i">GridSelectionFlags</span><span class="o">.</span><span class="i">MixRangeType</span>)));



            <span class="c">//for (int i = 0; i &lt; grid.TableDescriptor.Columns.Count; i++)</span>
            <span class="c">//    grid.TableDescriptor.Columns[i].AllowFilter = true;</span>

            <span class="c">//grid.TopLevelGroupOptions.ShowFilterBar = true;</span>
            <span class="c">//filter.WireGrid(grid);</span>

            <span class="c">//f2.WireGrid(grid);</span>
        }

        <span class="k">public</span> <span class="k">void</span> <span class="i">SetupSummaryRows</span>()
        {
            <span class="i">summaryRowDescriptor</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GridSummaryRowDescriptor</span>(<span class="s">&quot;Summary&quot;</span>);
            <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">Visible</span> <span class="o">=</span> <span class="k">false</span>;
            <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span class="i">Font</span><span class="o">.</span><span class="i">Bold</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">Title</span> <span class="o">=</span> <span class="s">&quot;Summary&quot;</span>;

            <span class="i">GridTableDescriptor</span> <span class="i">tableDescriptor</span> <span class="o">=</span> <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span>;

            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">SummaryRows</span><span class="o">.</span><span class="i">Add</span>(<span class="i">summaryRowDescriptor</span>);



            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">ShowCaptionSummaryCells</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionSummaryRow</span> <span class="o">=</span> <span class="s">&quot;Summary&quot;</span>;
            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionText</span> <span class="o">=</span> <span class="s">&quot;{Category} ({RecordCount})&quot;</span>;
            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">ShowSummaries</span> <span class="o">=</span> <span class="k">false</span>;
            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">ShowAddNewRecordBeforeDetails</span> <span class="o">=</span> <span class="k">false</span>;

            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">TopLevelGroupOptions</span><span class="o">.</span><span class="i">ShowCaptionSummaryCells</span> <span class="o">=</span> <span class="k">false</span>;


            <span class="i">summaryRowDescGrandTotal</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GridSummaryRowDescriptor</span>();
            <span class="i">tableDescriptor</span><span class="o">.</span><span class="i">SummaryRows</span><span class="o">.</span><span class="i">Add</span>(<span class="i">summaryRowDescGrandTotal</span>);

            <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span class="i">Font</span><span class="o">.</span><span class="i">Bold</span> <span class="o">=</span> <span class="k">true</span>;
            <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span class="i">TextColor</span> <span class="o">=</span> <span class="i">Color</span><span class="o">.</span><span class="i">WhiteSmoke</span>;

            <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span class="i">BackColor</span> <span class="o">=</span> <span class="i">Color</span><span class="o">.</span><span class="i">FromArgb</span>(<span class="n">185</span>, <span class="n">29</span>, <span class="n">71</span>);

            <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">Name</span> <span class="o">=</span> <span class="s">&quot;Total&quot;</span>;
            <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">Visible</span> <span class="o">=</span> <span class="k">true</span>;



        }

        <span class="k">public</span> <span class="k">void</span> <span class="i">AddSummaryCols</span>(<span onmouseout="hideTip(event, 'fs13', 132)" onmouseover="showTip(event, 'fs13', 132)" class="i">string</span>[] <span class="i">summaryFieldNames</span>)
        {
            <span class="c">//first clear any summaries</span>
            <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">Clear</span>();
            <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">Clear</span>();

            <span class="k">for</span> (<span onmouseout="hideTip(event, 'fs26', 133)" onmouseover="showTip(event, 'fs26', 133)" class="i">int</span> <span class="i">i</span> <span class="o">=</span> <span class="n">0</span>; <span class="i">i</span> <span class="o">&lt;</span> <span class="i">summaryFieldNames</span><span class="o">.</span><span class="i">GetLength</span>(<span class="n">0</span>); <span class="i">i</span><span class="o">++</span>)
                <span class="i">AddSummaryColumn</span>(<span class="i">summaryFieldNames</span>[<span class="i">i</span>], <span class="i">summaryRowDescriptor</span>, <span class="s">&quot;&quot;</span>);

            <span class="k">for</span> (<span onmouseout="hideTip(event, 'fs26', 134)" onmouseover="showTip(event, 'fs26', 134)" class="i">int</span> <span class="i">i</span> <span class="o">=</span> <span class="n">0</span>; <span class="i">i</span> <span class="o">&lt;</span> <span class="i">summaryFieldNames</span><span class="o">.</span><span class="i">GetLength</span>(<span class="n">0</span>); <span class="i">i</span><span class="o">++</span>)
                <span class="i">AddSummaryColumn</span>(<span class="i">summaryFieldNames</span>[<span class="i">i</span>], <span class="i">summaryRowDescGrandTotal</span>, <span class="s">&quot;&quot;</span>);
            

        }


        <span class="k">public</span> <span class="k">void</span> <span class="i">AddSummaryColumn</span>(<span onmouseout="hideTip(event, 'fs13', 135)" onmouseover="showTip(event, 'fs13', 135)" class="i">string</span> <span class="i">name</span>, <span class="i">GridSummaryRowDescriptor</span> <span class="i">summaryRowDescriptor</span>, <span onmouseout="hideTip(event, 'fs13', 136)" onmouseover="showTip(event, 'fs13', 136)" class="i">string</span> <span class="i">format</span>)
        {

            <span class="k">if</span> (<span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span><span class="o">.</span><span class="i">Contains</span>(<span class="i">name</span>) <span class="o">==</span> <span class="k">false</span>)
                <span class="k">return</span>;

            <span onmouseout="hideTip(event, 'fs13', 137)" onmouseover="showTip(event, 'fs13', 137)" class="i">string</span> <span class="i">SUM_FORMAT</span> <span class="o">=</span>  <span class="s">&quot;{{Sum:{0}}}&quot;</span>;


            <span onmouseout="hideTip(event, 'fs13', 138)" onmouseover="showTip(event, 'fs13', 138)" class="i">string</span> <span class="i">cellFormat</span> <span class="o">=</span> (<span class="i">format</span> <span class="o">!=</span> <span onmouseout="hideTip(event, 'fs13', 139)" onmouseover="showTip(event, 'fs13', 139)" class="i">string</span><span class="o">.</span><span class="i">Empty</span>) <span class="o">?</span> <span class="i">format</span> <span class="o">:</span> <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">name</span>]<span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyRecordFieldCell</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 140)" onmouseover="showTip(event, 'fs25', 140)" class="i">Format</span>; <span class="c">// (format != string.Empty) ? format : &quot;#,##0;(#,##0);-&quot;;</span>
            <span class="i">GridSummaryColumnDescriptor</span> <span class="i">summaryColumnDescriptor</span> <span class="o">=</span> <span class="k">null</span>;

            <span class="i">summaryColumnDescriptor</span> <span class="o">=</span> <span class="k">new</span> <span class="i">GridSummaryColumnDescriptor</span>(<span class="i">name</span>, <span class="i">SummaryType</span><span class="o">.</span><span class="i">DoubleAggregate</span>, <span class="i">name</span>, <span onmouseout="hideTip(event, 'fs13', 141)" onmouseover="showTip(event, 'fs13', 141)" class="i">string</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 142)" onmouseover="showTip(event, 'fs25', 142)" class="i">Format</span>(<span class="i">SUM_FORMAT</span>, <span class="i">cellFormat</span>));
            <span class="i">summaryColumnDescriptor</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 143)" onmouseover="showTip(event, 'fs25', 143)" class="i">Format</span> <span class="o">=</span> <span class="i">cellFormat</span>;
            <span class="i">summaryColumnDescriptor</span><span class="o">.</span><span class="i">Appearance</span><span class="o">.</span><span class="i">AnyCell</span><span class="o">.</span><span class="i">HorizontalAlignment</span> <span class="o">=</span> <span class="i">GridHorizontalAlignment</span><span class="o">.</span><span class="i">Right</span>;
            
            
            <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">Add</span>(<span class="i">summaryColumnDescriptor</span>);
            <span class="c">//			SummaryColList.Add(new SummarySortInfo(mappingNameA, summaryColumnDescriptor.GetSummaryDescriptorName(),false));</span>
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">button3_Click</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {

        }
        

        <span class="k">private</span> <span class="k">void</span> <span class="i">button1_Click</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="c">//            if (this.currentView != null &amp;&amp; this.currentView</span>
  <span class="c">//          if (this.currentView == null || this.currentView != comboBox1.SelectedItem.ToString())</span>
            {
                <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Summaries</span><span class="o">.</span><span class="i">Clear</span>();
                <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">GroupedColumns</span><span class="o">.</span><span class="i">Clear</span>();
                <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">SortedColumns</span><span class="o">.</span><span class="i">Clear</span>();
                <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">RecordFilters</span><span class="o">.</span><span class="i">Clear</span>();
                <span class="c">//              this.grid.TableDescriptor.Columns.Reset();</span>
           }

            <span class="c">//this.grid.DataSource = null;</span>


            <span class="i">var</span> <span class="i">starttime</span> <span class="o">=</span> <span class="i">DateTime</span><span class="o">.</span><span class="i">Now</span>;
            <span class="i">this</span><span class="o">.</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span><span class="o">.</span><span class="i">Reset</span>();
            <span class="i">LoadAndApply</span>(<span class="i">comboBox1</span><span class="o">.</span><span class="i">SelectedItem</span><span class="o">.</span><span class="i">ToString</span>(), <span class="s">&quot;&quot;</span>);
            <span class="i">checkBox1_CheckedChanged</span>(<span class="i">sender</span>, <span class="i">e</span>);
            
          <span class="c">//  MessageBox.Show(&quot;time now&quot; + DateTime.Now.ToLongTimeString() + &quot; prev: &quot; + starttime.ToLongTimeString());</span>
        }


        <span class="k">void</span> <span class="i">OptimizeGrid</span>(<span class="i">GridGroupingControl</span> <span class="i">gridGroupingControl</span>)
        {
            <span class="c">// Couple settings to perform better:</span>
            <span class="i">gridGroupingControl</span><span class="o">.</span><span class="i">Engine</span><span class="o">.</span><span class="i">CounterLogic</span> <span class="o">=</span> <span class="i">EngineCounters</span><span class="o">.</span><span class="i">FilteredRecords</span>;
            <span class="i">gridGroupingControl</span><span class="o">.</span><span class="i">Engine</span><span class="o">.</span><span class="i">AllowedOptimizations</span> <span class="o">=</span>
            <span class="i">EngineOptimizations</span><span class="o">.</span><span class="i">DisableCounters</span>
            | <span class="i">EngineOptimizations</span><span class="o">.</span><span class="i">RecordsAsDisplayElements</span>
            | <span class="i">EngineOptimizations</span><span class="o">.</span><span class="i">VirtualMode</span>
            ;
            <span class="i">gridGroupingControl</span><span class="o">.</span><span class="i">TableOptions</span><span class="o">.</span><span class="i">VerticalPixelScroll</span> <span class="o">=</span> <span class="k">false</span>;
            <span class="i">gridGroupingControl</span><span class="o">.</span><span class="i">Engine</span><span class="o">.</span><span class="i">TableOptions</span><span class="o">.</span><span class="i">ColumnsMaxLengthStrategy</span> <span class="o">=</span> <span class="i">GridColumnsMaxLengthStrategy</span><span class="o">.</span><span class="i">FirstNRecords</span>;
            <span class="i">gridGroupingControl</span><span class="o">.</span><span class="i">Engine</span><span class="o">.</span><span class="i">TableOptions</span><span class="o">.</span><span class="i">ColumnsMaxLengthFirstNRecords</span> <span class="o">=</span> <span class="n">100</span>;
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">LoadData</span>(<span onmouseout="hideTip(event, 'fs13', 144)" onmouseover="showTip(event, 'fs13', 144)" class="i">string</span> <span class="i">name</span>, <span onmouseout="hideTip(event, 'fs13', 145)" onmouseover="showTip(event, 'fs13', 145)" class="i">string</span> <span class="i">d1</span>, <span onmouseout="hideTip(event, 'fs13', 146)" onmouseover="showTip(event, 'fs13', 146)" class="i">string</span> <span class="i">d2</span>)
        {
            <span class="c">//System.Diagnostics.Debug.WriteLine(&quot;1   &quot; + System.DateTime.Now.ToLongTimeString());</span>
            <span class="c">//currentView = MBS_POS.myViews[name];</span>
            <span class="c">//srcCurrent = MBS_POS.GetData(name, d1, d2);</span>

            <span class="c">//System.Diagnostics.Debug.WriteLine(&quot;2   &quot; + System.DateTime.Now.ToLongTimeString());</span>
   
            <span class="c">//var summarycols = currentView.diffcols;</span>
            <span class="c">//List&lt;string&gt; ls = new List&lt;string&gt;();</span>
            <span class="c">//if (currentView.iscomparable &amp;&amp; d1 != d2)</span>
            <span class="c">//{</span>
            <span class="c">//    srcCompare = MBS_POS.GetData(name, d2, d2);</span>
            <span class="c">//    System.Diagnostics.Debug.WriteLine(&quot;2.1   &quot; + System.DateTime.Now.ToLongTimeString());</span>

            <span class="c">//    src = Util.MergeTables(srcCurrent, srcCompare, currentView.PKCols, currentView.diffcols);</span>
            <span class="c">//    System.Diagnostics.Debug.WriteLine(&quot;2.2   &quot; + System.DateTime.Now.ToLongTimeString());</span>

            <span class="c">//    foreach (string s in currentView.diffcols)</span>
            <span class="c">//    {</span>
            <span class="c">//        ls.Add(s);</span>
            <span class="c">//        ls.Add(s + &quot;_DIFF&quot;);</span>
            <span class="c">//        ls.Add(s + &quot;_PREV&quot;);</span>
            <span class="c">//    }</span>
            <span class="c">//    System.Diagnostics.Debug.WriteLine(&quot;2.3   &quot; + System.DateTime.Now.ToLongTimeString());</span>

            <span class="c">//}</span>
            <span class="c">//else</span>
            <span class="c">//{</span>
            <span class="c">//    src = srcCurrent;</span>
            <span class="c">//    srcCompare = null;</span>
            <span class="c">//    foreach (string s in currentView.diffcols)</span>
            <span class="c">//        ls.Add(s);</span>
            <span class="c">//}</span>
            <span class="c">//System.Diagnostics.Debug.WriteLine(&quot;3   &quot; + System.DateTime.Now.ToLongTimeString());</span>

            <span class="c">//grid.DataSource = src;</span>

            <span class="c">//FormatCols();</span>
            <span class="c">//System.Diagnostics.Debug.WriteLine(&quot;4   &quot; + System.DateTime.Now.ToLongTimeString());</span>

            <span class="c">//AddSummaryCols(ls.ToArray());</span>
            <span class="c">//System.Diagnostics.Debug.WriteLine(&quot;5   &quot; + System.DateTime.Now.ToLongTimeString());</span>
         
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">FormatCols</span>()
        {
            <span class="c">//var cols = src.Columns;</span>
            <span class="c">//foreach (DataColumn col in cols)</span>
            <span class="c">//{</span>
            <span class="c">//    var fmt = MBS_POS.GetNumericFormat(col.ColumnName, src);</span>
            <span class="c">//    grid.TableDescriptor.Columns[col.ColumnName].Appearance.AnyRecordFieldCell.CellType = &quot;Static&quot;;</span>
            <span class="c">//    grid.TableDescriptor.Columns[col.ColumnName].Appearance.AnyRecordFieldCell.ReadOnly = true;</span>
            <span class="c">//    grid.TableDescriptor.Columns[col.ColumnName].Appearance.AnyRecordFieldCell.Format = fmt;</span>
            <span class="c">//}</span>
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">button3_Click_1</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="k">if</span> (<span class="i">srcCurrent</span> <span class="o">==</span> <span class="k">null</span>)
            {
                <span class="i">MessageBox</span><span class="o">.</span><span class="i">Show</span>(<span class="s">&quot;ERR! No Data Loaded&quot;</span>);
                <span class="k">return</span>;
            }
            <span class="i">var</span> <span class="i">filter</span> <span class="o">=</span> <span class="i">textBox1</span><span class="o">.</span><span class="i">SelectedText</span><span class="o">.</span><span class="i">Trim</span>()<span class="o">.</span><span class="i">Length</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="o">?</span> <span class="i">textBox1</span><span class="o">.</span><span class="i">SelectedText</span> <span class="o">:</span> <span class="i">textBox1</span><span class="o">.</span><span class="i">Text</span><span class="o">.</span><span class="i">Trim</span>()<span class="o">.</span><span class="i">Length</span> <span class="o">&gt;</span> <span class="n">0</span> <span class="o">?</span> <span class="i">textBox1</span><span class="o">.</span><span class="i">Text</span> <span class="o">:</span> <span class="s">&quot;TRUE&quot;</span>;
            <span class="i">ApplyFilter</span>(<span class="i">filter</span>);
            <span class="i">checkBox1_CheckedChanged</span>(<span class="i">sender</span>, <span class="i">e</span>);
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">ApplyFilter</span>(<span onmouseout="hideTip(event, 'fs13', 147)" onmouseover="showTip(event, 'fs13', 147)" class="i">string</span> <span class="i">filter</span>)
        {
            <span class="k">try</span>
            {
                <span class="i">DataTable</span> <span class="i">res</span> <span class="o">=</span> <span class="k">null</span>;
                <span class="k">if</span> (<span class="i">srcCompare</span> <span class="o">!=</span> <span class="k">null</span>)
                {

                    <span class="k">if</span> ((<span onmouseout="hideTip(event, 'fs13', 148)" onmouseover="showTip(event, 'fs13', 148)" class="i">string</span><span class="o">.</span><span class="i">IsNullOrWhiteSpace</span>(<span class="i">filter</span>) <span class="o">||</span> <span class="i">filter</span><span class="o">.</span><span class="i">ToUpper</span>()<span class="o">.</span><span class="i">Trim</span>()<span class="o">.</span><span class="i">Equals</span>(<span class="s">&quot;TRUE&quot;</span>)) <span class="o">&amp;&amp;</span> <span class="i">srcJoined</span> <span class="o">!=</span> <span class="k">null</span>)
                    {
                        <span class="i">res</span> <span class="o">=</span> <span class="i">srcJoined</span>;
                    }
                    <span class="k">else</span>
                    {
                        <span onmouseout="hideTip(event, 'fs2', 149)" onmouseover="showTip(event, 'fs2', 149)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 150)" onmouseover="showTip(event, 'fs16', 150)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 151)" onmouseover="showTip(event, 'fs17', 151)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 152)" onmouseover="showTip(event, 'fs18', 152)" class="i">WriteLine</span>(<span class="s">&quot;before apply: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 153)" onmouseover="showTip(event, 'fs2', 153)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 154)" onmouseover="showTip(event, 'fs19', 154)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 155)" onmouseover="showTip(event, 'fs20', 155)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 156)" onmouseover="showTip(event, 'fs21', 156)" class="i">ToLongTimeString</span>());
                        <span class="i">var</span> <span class="i">filteredCurrent</span> <span class="o">=</span> <span class="i">Utility</span><span class="o">.</span><span class="i">ToDT</span>(<span class="i">DSLParser</span><span class="o">.</span><span class="i">ProcessViewFilter</span>(<span class="i">filter</span>, <span class="i">srcCurrent</span><span class="o">.</span><span class="i">AsEnumerable</span>()));
                        <span onmouseout="hideTip(event, 'fs2', 157)" onmouseover="showTip(event, 'fs2', 157)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 158)" onmouseover="showTip(event, 'fs16', 158)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 159)" onmouseover="showTip(event, 'fs17', 159)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 160)" onmouseover="showTip(event, 'fs18', 160)" class="i">WriteLine</span>(<span class="s">&quot;before apply 1: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 161)" onmouseover="showTip(event, 'fs2', 161)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 162)" onmouseover="showTip(event, 'fs19', 162)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 163)" onmouseover="showTip(event, 'fs20', 163)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 164)" onmouseover="showTip(event, 'fs21', 164)" class="i">ToLongTimeString</span>());
                        <span class="i">var</span> <span class="i">filteredCompare</span> <span class="o">=</span> <span class="i">Utility</span><span class="o">.</span><span class="i">ToDT</span>(<span class="i">DSLParser</span><span class="o">.</span><span class="i">ProcessViewFilter</span>(<span class="i">filter</span>, <span class="i">srcCompare</span><span class="o">.</span><span class="i">AsEnumerable</span>()));
                        <span onmouseout="hideTip(event, 'fs2', 165)" onmouseover="showTip(event, 'fs2', 165)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 166)" onmouseover="showTip(event, 'fs16', 166)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 167)" onmouseover="showTip(event, 'fs17', 167)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 168)" onmouseover="showTip(event, 'fs18', 168)" class="i">WriteLine</span>(<span class="s">&quot;before apply 2: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 169)" onmouseover="showTip(event, 'fs2', 169)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 170)" onmouseover="showTip(event, 'fs19', 170)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 171)" onmouseover="showTip(event, 'fs20', 171)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 172)" onmouseover="showTip(event, 'fs21', 172)" class="i">ToLongTimeString</span>());
                        <span class="i">res</span> <span class="o">=</span> <span class="i">Utility</span><span class="o">.</span><span class="i">MergeTables</span>(<span class="i">filteredCurrent</span>, <span class="i">filteredCompare</span>, <span class="i">pk_cols</span>, <span class="i">diff_cols</span>);
                        <span onmouseout="hideTip(event, 'fs2', 173)" onmouseover="showTip(event, 'fs2', 173)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 174)" onmouseover="showTip(event, 'fs16', 174)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 175)" onmouseover="showTip(event, 'fs17', 175)" class="i">Debug</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 176)" onmouseover="showTip(event, 'fs18', 176)" class="i">WriteLine</span>(<span class="s">&quot;after apply: &quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs2', 177)" onmouseover="showTip(event, 'fs2', 177)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 178)" onmouseover="showTip(event, 'fs19', 178)" class="i">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 179)" onmouseover="showTip(event, 'fs20', 179)" class="i">Now</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 180)" onmouseover="showTip(event, 'fs21', 180)" class="i">ToLongTimeString</span>());

                        <span class="k">if</span> ((<span onmouseout="hideTip(event, 'fs13', 181)" onmouseover="showTip(event, 'fs13', 181)" class="i">string</span><span class="o">.</span><span class="i">IsNullOrWhiteSpace</span>(<span class="i">filter</span>) <span class="o">||</span> <span class="i">filter</span><span class="o">.</span><span class="i">ToUpper</span>()<span class="o">.</span><span class="i">Trim</span>()<span class="o">.</span><span class="i">Equals</span>(<span class="s">&quot;TRUE&quot;</span>)) <span class="o">&amp;&amp;</span> <span class="i">srcJoined</span> <span class="o">==</span> <span class="k">null</span>)
                        {
                            <span class="i">srcJoined</span> <span class="o">=</span> <span class="i">res</span>;
                        }
                    }
                }
                <span class="k">else</span>
                {
                    <span class="i">res</span> <span class="o">=</span> <span class="i">Utility</span><span class="o">.</span><span class="i">ToDT</span>(<span class="i">DSLParser</span><span class="o">.</span><span class="i">ProcessViewFilter</span>(<span class="i">filter</span>, <span class="i">srcCurrent</span><span class="o">.</span><span class="i">AsEnumerable</span>()));
                }

                <span class="i">grid</span><span class="o">.</span><span class="i">DataSource</span> <span class="o">=</span> <span class="i">res</span>;
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span><span class="o">.</span><span class="i">Reset</span>();

                <span class="i">this</span><span class="o">.</span><span class="i">Text</span> <span class="o">=</span>  <span class="i">filter</span>;
            }
            <span class="i">catch</span> (<span class="i">Exception</span> <span class="i">ex</span>)
            {
                <span class="i">MessageBox</span><span class="o">.</span><span class="i">Show</span>(<span class="s">&quot;ERR!&quot;</span> <span class="o">+</span> <span class="i">ex</span><span class="o">.</span><span class="i">Message</span>);
            }
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">textBox1_MouseHover</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {

            <span class="i">var</span> <span class="i">t</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>;<span class="c">//DSLParser.ParseToString(textBox1.Text);</span>
            <span class="i">TextBox</span> <span class="i">TB</span> <span class="o">=</span> (<span class="i">TextBox</span>)<span class="i">sender</span>;
            <span onmouseout="hideTip(event, 'fs26', 182)" onmouseover="showTip(event, 'fs26', 182)" class="i">int</span> <span class="i">VisibleTime</span> <span class="o">=</span> <span class="n">10000</span>;  <span class="c">//in milliseconds</span>

            <span class="i">ToolTip</span> <span class="i">tt</span> <span class="o">=</span> <span class="k">new</span> <span class="i">ToolTip</span>();
            <span class="i">tt</span><span class="o">.</span><span class="i">Show</span>(<span class="i">t</span>, <span class="i">TB</span>, <span class="n">0</span>, <span class="n">0</span>, <span class="i">VisibleTime</span>);

        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">button2_Click</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="i">var</span> <span class="i">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="i">StringBuilder</span>();
            <span class="i">var</span> <span class="i">v</span> <span class="o">=</span> (<span class="i">DataTable</span>)<span class="i">grid</span><span class="o">.</span><span class="i">DataSource</span>;
            <span class="i">var</span> <span class="i">headers</span> <span class="o">=</span> <span class="i">v</span><span class="o">.</span><span class="i">Columns</span><span class="o">.</span><span class="i">Cast</span><span class="o">&lt;</span><span class="i">DataColumn</span><span class="o">&gt;</span>();<span class="c">// .Columns.Cast&lt;DataGridViewColumn&gt;();</span>
            <span class="i">sb</span><span class="o">.</span><span class="i">AppendLine</span>(<span onmouseout="hideTip(event, 'fs13', 183)" onmouseover="showTip(event, 'fs13', 183)" class="i">string</span><span class="o">.</span><span class="i">Join</span>(<span class="s">&quot;,&quot;</span>, <span class="i">headers</span><span class="o">.</span><span class="i">Select</span>(<span class="i">column</span> <span class="o">=&gt;</span> <span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="i">column</span><span class="o">.</span><span class="i">ColumnName</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span>)<span class="o">.</span><span class="i">ToArray</span>()));

            <span class="i">foreach</span> (<span class="i">DataRowView</span> <span class="i">row</span> <span class="k">in</span> <span class="i">v</span><span class="o">.</span><span class="i">DefaultView</span>)
            {
                <span class="i">var</span> <span class="i">cells</span> <span class="o">=</span> <span class="i">row</span><span class="o">.</span><span class="i">Row</span><span class="o">.</span><span class="i">ItemArray</span>;<span class="c">// row.Cells.Cast&lt;DataGridViewCell&gt;();</span>
                <span class="i">sb</span><span class="o">.</span><span class="i">AppendLine</span>(<span onmouseout="hideTip(event, 'fs13', 184)" onmouseover="showTip(event, 'fs13', 184)" class="i">string</span><span class="o">.</span><span class="i">Join</span>(<span class="s">&quot;,&quot;</span>, <span class="i">cells</span><span class="o">.</span><span class="i">Select</span>(<span class="i">cell</span> <span class="o">=&gt;</span> <span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="i">cell</span><span class="o">.</span><span class="i">ToString</span>() <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span>)<span class="o">.</span><span class="i">ToArray</span>()));
            }
            <span class="i">var</span> <span class="i">writer</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs2', 185)" onmouseover="showTip(event, 'fs2', 185)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 186)" onmouseover="showTip(event, 'fs29', 186)" class="i">IO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 187)" onmouseover="showTip(event, 'fs30', 187)" class="i">StreamWriter</span>(<span class="s">@&quot;C:\temp\test.csv&quot;</span>);
            <span class="i">writer</span><span class="o">.</span><span class="i">Write</span>(<span class="i">sb</span><span class="o">.</span><span class="i">ToString</span>());
            <span class="i">writer</span><span class="o">.</span><span class="i">Close</span>();
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">button4_Click</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="k">try</span>
            {
                <span class="i">var</span> <span class="i">defaultMRQL</span> <span class="o">=</span> <span class="i">Controller</span><span class="o">.</span><span class="i">GetSourceAttribute</span>(<span class="i">comboBox1</span><span class="o">.</span><span class="i">SelectedItem</span><span class="o">.</span><span class="i">ToString</span>(), <span class="s">&quot;mrql&quot;</span>);
                <span class="i">ExpressionsMgr</span><span class="o">.</span><span class="i">LoadDSL</span>(<span class="i">defaultMRQL</span>);
            }
            <span class="i">catch</span> (<span class="i">Exception</span>)
            {
                <span class="i">MessageBox</span><span class="o">.</span><span class="i">Show</span>(<span class="s">&quot;No default measure file to show&quot;</span>);
            }
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">checkBox1_CheckedChanged</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="i">cachedSummaryCols</span> <span class="o">=</span> <span class="k">null</span>;
            <span class="k">if</span> (<span class="i">checkBox1</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 188)" onmouseover="showTip(event, 'fs22', 188)" class="i">Checked</span>)
            {
                <span class="c">//get all summary and grouped columns..hide everything else</span>
                <span class="i">cachedCols</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span><span class="o">.</span><span class="i">Clone</span>();

                <span class="k">if</span> (<span class="i">cachedSummaryCols</span> <span class="o">==</span> <span class="k">null</span>)
                {
                    <span class="i">foreach</span> (<span class="i">var</span> <span class="i">cols</span> <span class="k">in</span> <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>)
                        <span class="k">if</span> ((<span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">IndexOf</span>(<span class="i">cols</span><span class="o">.</span><span class="i">Name</span>) <span class="o">&lt;</span> <span class="n">0</span>) <span class="o">/*&amp;&amp;</span> (<span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">GroupedColumns</span><span class="o">.</span><span class="i">IndexOf</span>(<span class="i">cols</span><span class="o">.</span><span class="i">Name</span>) <span class="o">&lt;</span> <span class="n">0</span>)<span class="o">*/</span>)
                        {
                            <span class="k">if</span> (<span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span><span class="o">.</span><span class="i">IndexOf</span>(<span class="i">cols</span><span class="o">.</span><span class="i">Name</span>) <span class="o">&gt;</span> <span class="n">0</span>)
                                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span><span class="o">.</span><span class="i">Remove</span>(<span class="i">cols</span><span class="o">.</span><span class="i">Name</span>);
                        }
                }
                <span class="k">else</span>
                {
                    <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span> <span class="o">=</span> <span class="i">cachedSummaryCols</span>;
                }
            }
            <span class="k">else</span>
            {
                <span class="i">cachedSummaryCols</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span><span class="o">.</span><span class="i">Clone</span>();
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">VisibleColumns</span> <span class="o">=</span> <span class="i">cachedCols</span>;

                <span class="c">//foreach (var cols in grid.TableDescriptor.Columns)</span>
                <span class="c">//{</span>
                <span class="c">//        grid.TableDescriptor.VisibleColumns.Add(cols.Name);</span>
                <span class="c">//}</span>
            }
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">checkBox2_CheckedChanged</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="i">dateTimePicker2</span><span class="o">.</span><span class="i">Visible</span> <span class="o">=</span> <span class="i">label2</span><span class="o">.</span><span class="i">Visible</span> <span class="o">=</span> <span class="i">checkBox2</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 189)" onmouseover="showTip(event, 'fs22', 189)" class="i">Checked</span>;
        }


        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="i">RemoveDuplicatesFromDataTable</span>(<span onmouseout="hideTip(event, 'fs24', 190)" onmouseover="showTip(event, 'fs24', 190)" class="i">ref</span> <span class="i">DataTable</span> <span class="i">table</span>, <span onmouseout="hideTip(event, 'fs23', 191)" onmouseover="showTip(event, 'fs23', 191)" class="i">List</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 192)" onmouseover="showTip(event, 'fs13', 192)" class="i">string</span><span class="o">&gt;</span> <span class="i">keyColumns</span>)
        {
           
           

            <span class="i">Dictionary</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 193)" onmouseover="showTip(event, 'fs13', 193)" class="i">string</span>, <span onmouseout="hideTip(event, 'fs13', 194)" onmouseover="showTip(event, 'fs13', 194)" class="i">string</span><span class="o">&gt;</span> <span class="i">uniquenessDict</span> <span class="o">=</span> <span class="k">new</span> <span class="i">Dictionary</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs13', 195)" onmouseover="showTip(event, 'fs13', 195)" class="i">string</span>, <span onmouseout="hideTip(event, 'fs13', 196)" onmouseover="showTip(event, 'fs13', 196)" class="i">string</span><span class="o">&gt;</span>(<span class="i">table</span><span class="o">.</span><span class="i">Rows</span><span class="o">.</span><span class="i">Count</span>);

            <span class="i">StringBuilder</span> <span class="i">stringBuilder</span> <span class="o">=</span> <span class="k">null</span>;

            <span onmouseout="hideTip(event, 'fs26', 197)" onmouseover="showTip(event, 'fs26', 197)" class="i">int</span> <span class="i">rowIndex</span> <span class="o">=</span> <span class="n">0</span>;

            <span class="i">DataRow</span> <span class="i">row</span>;

            <span class="i">DataRowCollection</span> <span class="i">rows</span> <span class="o">=</span> <span class="i">table</span><span class="o">.</span><span class="i">Rows</span>;

            <span class="k">while</span> (<span class="i">rowIndex</span> <span class="o">&lt;</span> <span class="i">rows</span><span class="o">.</span><span class="i">Count</span>)
            {

                <span class="i">row</span> <span class="o">=</span> <span class="i">rows</span>[<span class="i">rowIndex</span>];

<span class="c">//check if all the pk cols are null..if yes, delete the row</span>
                <span class="i">var</span> <span class="i">isAllNull</span> <span class="o">=</span> <span class="k">true</span>;
                <span class="i">foreach</span> (<span onmouseout="hideTip(event, 'fs13', 198)" onmouseover="showTip(event, 'fs13', 198)" class="i">string</span> <span class="i">colname</span> <span class="k">in</span> <span class="i">keyColumns</span>)
                {

                    <span class="k">if</span> (<span class="i">row</span>[<span class="i">colname</span>] <span class="o">!=</span> <span class="i">DBNull</span><span class="o">.</span><span class="i">Value</span>)
                    {
                        <span class="i">isAllNull</span> <span class="o">=</span> <span class="k">false</span>;
                    }


                }

                <span class="k">if</span> (<span class="i">isAllNull</span>)
                {
                    <span class="i">rows</span><span class="o">.</span><span class="i">Remove</span>(<span class="i">row</span>);
                    <span class="i">continue</span>;
                }
<span class="c">////end checking for nulls</span>
                <span class="i">stringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="i">StringBuilder</span>();

                <span class="i">foreach</span> (<span onmouseout="hideTip(event, 'fs13', 199)" onmouseover="showTip(event, 'fs13', 199)" class="i">string</span> <span class="i">colname</span> <span class="k">in</span> <span class="i">keyColumns</span>)
                {

                        <span class="i">stringBuilder</span><span class="o">.</span><span class="i">Append</span>(((<span onmouseout="hideTip(event, 'fs13', 200)" onmouseover="showTip(event, 'fs13', 200)" class="i">string</span>)<span class="i">row</span>[<span class="i">colname</span>]));


                }

                <span class="k">if</span> (<span class="i">uniquenessDict</span><span class="o">.</span><span class="i">ContainsKey</span>(<span class="i">stringBuilder</span><span class="o">.</span><span class="i">ToString</span>()))
                {

                    <span class="i">rows</span><span class="o">.</span><span class="i">Remove</span>(<span class="i">row</span>);

                }

                <span class="k">else</span>
                {

                    <span class="i">uniquenessDict</span><span class="o">.</span><span class="i">Add</span>(<span class="i">stringBuilder</span><span class="o">.</span><span class="i">ToString</span>(), <span onmouseout="hideTip(event, 'fs13', 201)" onmouseover="showTip(event, 'fs13', 201)" class="i">string</span><span class="o">.</span><span class="i">Empty</span>);

                    <span class="i">rowIndex</span><span class="o">++</span>;

                }

            }

        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">button5_Click</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="i">Form</span> <span class="i">frm</span> <span class="o">=</span> <span class="k">new</span> <span class="i">MainForm</span>();
            <span class="i">frm</span><span class="o">.</span><span class="i">Show</span>();
        }


        <span class="k">private</span> <span class="k">void</span> <span class="i">button6_Click</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {
            <span class="i">FieldDescriptor</span> <span class="i">currentFieldDescriptor</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">CurrentRecordManager</span><span class="o">.</span><span class="i">CurrentField</span>;
            <span class="k">if</span> (<span class="i">currentFieldDescriptor</span> <span class="o">!=</span> <span class="k">null</span>)
            {
                <span onmouseout="hideTip(event, 'fs13', 202)" onmouseover="showTip(event, 'fs13', 202)" class="i">string</span> <span class="i">currentColName</span> <span class="o">=</span> <span class="i">currentFieldDescriptor</span><span class="o">.</span><span class="i">Name</span>;
                <span class="i">AddSummaryColumn</span>(<span class="i">currentColName</span>, <span class="i">summaryRowDescriptor</span>, <span class="s">&quot;&quot;</span>);
                <span class="i">AddSummaryColumn</span>(<span class="i">currentColName</span>, <span class="i">summaryRowDescGrandTotal</span>, <span class="s">&quot;&quot;</span>);
            }
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">ToggleSummary</span>()
        {
            <span class="i">FieldDescriptor</span> <span class="i">currentFieldDescriptor</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">CurrentRecordManager</span><span class="o">.</span><span class="i">CurrentField</span>;
            <span class="k">if</span> (<span class="i">currentFieldDescriptor</span> <span class="o">!=</span> <span class="k">null</span>)
            {
                
                <span onmouseout="hideTip(event, 'fs13', 203)" onmouseover="showTip(event, 'fs13', 203)" class="i">string</span> <span class="i">currentColName</span> <span class="o">=</span> <span class="i">currentFieldDescriptor</span><span class="o">.</span><span class="i">Name</span>;

                <span class="k">if</span> (<span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">Contains</span>(<span class="i">currentColName</span>))
                {
                    <span class="i">var</span> <span class="i">sTotal</span> <span class="o">=</span> <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">SummaryColumns</span>[<span class="i">currentColName</span>];
                    <span class="i">var</span> <span class="i">sGrandTotal</span> <span class="o">=</span> <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">SummaryColumns</span>[<span class="i">currentColName</span>];
                    <span class="i">summaryRowDescriptor</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">Remove</span>(<span class="i">sTotal</span>);
                    <span class="i">summaryRowDescGrandTotal</span><span class="o">.</span><span class="i">SummaryColumns</span><span class="o">.</span><span class="i">Remove</span>(<span class="i">sGrandTotal</span>);
                }
                <span class="k">else</span>
                {
                    <span class="i">AddSummaryColumn</span>(<span class="i">currentColName</span>, <span class="i">summaryRowDescriptor</span>, <span class="s">&quot;#,##0;(#,##0);-&quot;</span>);
                    <span class="i">AddSummaryColumn</span>(<span class="i">currentColName</span>, <span class="i">summaryRowDescGrandTotal</span>, <span class="s">&quot;#,##0;(#,##0);-&quot;</span>);
                }
            }
        }
        <span class="k">private</span> <span class="k">void</span> <span class="i">ToggleFilter</span>()
        {
            <span class="i">FieldDescriptor</span> <span class="i">currentFieldDescriptor</span> <span class="o">=</span> <span class="i">grid</span><span class="o">.</span><span class="i">Table</span><span class="o">.</span><span class="i">CurrentRecordManager</span><span class="o">.</span><span class="i">CurrentField</span>;
            <span class="k">if</span> (<span class="i">currentFieldDescriptor</span> <span class="o">!=</span> <span class="k">null</span>)
            {
                <span onmouseout="hideTip(event, 'fs13', 204)" onmouseover="showTip(event, 'fs13', 204)" class="i">string</span> <span class="i">currentColName</span> <span class="o">=</span> <span class="i">currentFieldDescriptor</span><span class="o">.</span><span class="i">Name</span>;
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">currentColName</span>]<span class="o">.</span><span class="i">AllowFilter</span> <span class="o">=</span> <span class="o">!</span><span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">Columns</span>[<span class="i">currentColName</span>]<span class="o">.</span><span class="i">AllowFilter</span>;
            }
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">ToggleCaption</span>()
        {
            <span class="k">if</span> (<span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionText</span> <span class="o">==</span> <span class="s">&quot;{Category} ({RecordCount})&quot;</span>)
            {
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionText</span> <span class="o">=</span> <span class="s">&quot;{Category}&quot;</span>;
            }
            <span class="k">else</span>
            {
                <span class="i">grid</span><span class="o">.</span><span class="i">TableDescriptor</span><span class="o">.</span><span class="i">ChildGroupOptions</span><span class="o">.</span><span class="i">CaptionText</span> <span class="o">=</span> <span class="s">&quot;{Category} ({RecordCount})&quot;</span>;
            }
           

        }

        <span class="i">protected</span> <span class="k">override</span> <span onmouseout="hideTip(event, 'fs27', 205)" onmouseover="showTip(event, 'fs27', 205)" class="i">bool</span> <span class="i">ProcessCmdKey</span>(<span onmouseout="hideTip(event, 'fs24', 206)" onmouseover="showTip(event, 'fs24', 206)" class="i">ref</span> <span class="i">Message</span> <span class="i">msg</span>, <span class="i">Keys</span> <span class="i">keyData</span>)
        {
            <span class="k">if</span> (<span class="i">keyData</span> <span class="o">==</span> (<span class="i">Keys</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 207)" onmouseover="showTip(event, 'fs31', 207)" class="i">Control</span> | <span class="i">Keys</span><span class="o">.</span><span class="i">F</span>))
            {
                <span class="i">Find</span>();
            }
            <span class="k">else</span> <span class="k">if</span> (<span class="i">keyData</span> <span class="o">==</span> (<span class="i">Keys</span><span class="o">.</span><span class="i">Alt</span> | <span class="i">Keys</span><span class="o">.</span><span class="i">F</span>))
            {
                <span class="i">ToggleFilter</span>();
            }
            <span class="k">else</span> <span class="k">if</span> (<span class="i">keyData</span> <span class="o">==</span> (<span class="i">Keys</span><span class="o">.</span><span class="i">Alt</span> | <span class="i">Keys</span><span class="o">.</span><span class="i">S</span>))
            {
                <span class="i">ToggleSummary</span>();
            }
            <span class="k">else</span> <span class="k">if</span> (<span class="i">keyData</span> <span class="o">==</span> (<span class="i">Keys</span><span class="o">.</span><span class="i">Alt</span> | <span class="i">Keys</span><span class="o">.</span><span class="i">C</span>))
            {
                <span class="i">ToggleCaption</span>();
            }


            <span class="k">return</span> <span class="k">base</span><span class="o">.</span><span class="i">ProcessCmdKey</span>(<span onmouseout="hideTip(event, 'fs24', 208)" onmouseover="showTip(event, 'fs24', 208)" class="i">ref</span> <span class="i">msg</span>, <span class="i">keyData</span>);
        }

        <span class="k">private</span> <span class="k">void</span> <span class="i">button2_Click_1</span>(<span class="i">object</span> <span class="i">sender</span>, <span class="i">EventArgs</span> <span class="i">e</span>)
        {

        }

    }
}
</code></pre></td>
</tr>
</table>
<div class="tip" id="fs1">val using : resource:&#39;T -&gt; action:(&#39;T -&gt; &#39;U) -&gt; &#39;U (requires &#39;T :&gt; System.IDisposable)<br /><br />Full name: Microsoft.FSharp.Core.Operators.using</div>
<div class="tip" id="fs2">namespace System</div>
<div class="tip" id="fs3">namespace System.Collections</div>
<div class="tip" id="fs4">namespace System.Collections.Generic</div>
<div class="tip" id="fs5">namespace System.ComponentModel</div>
<div class="tip" id="fs6">namespace System.Data</div>
<div class="tip" id="fs7">namespace System.Drawing</div>
<div class="tip" id="fs8">namespace System.Linq</div>
<div class="tip" id="fs9">namespace System.Text</div>
<div class="tip" id="fs10">namespace System.Windows</div>
<div class="tip" id="fs11">namespace System.Windows.Forms</div>
<div class="tip" id="fs12">namespace System.Configuration</div>
<div class="tip" id="fs13">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs14">val typeof&lt;&#39;T&gt; : System.Type<br /><br />Full name: Microsoft.FSharp.Core.Operators.typeof</div>
<div class="tip" id="fs15">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs16">namespace System.Diagnostics</div>
<div class="tip" id="fs17">type Debug =<br />&#160;&#160;static member Assert : condition:bool -&gt; unit + 3 overloads<br />&#160;&#160;static member AutoFlush : bool with get, set<br />&#160;&#160;static member Close : unit -&gt; unit<br />&#160;&#160;static member Fail : message:string -&gt; unit + 1 overload<br />&#160;&#160;static member Flush : unit -&gt; unit<br />&#160;&#160;static member Indent : unit -&gt; unit<br />&#160;&#160;static member IndentLevel : int with get, set<br />&#160;&#160;static member IndentSize : int with get, set<br />&#160;&#160;static member Listeners : TraceListenerCollection<br />&#160;&#160;static member Print : message:string -&gt; unit + 1 overload<br />&#160;&#160;...<br /><br />Full name: System.Diagnostics.Debug</div>
<div class="tip" id="fs18">System.Diagnostics.Debug.WriteLine(value: obj) : unit<br />System.Diagnostics.Debug.WriteLine(message: string) : unit<br />System.Diagnostics.Debug.WriteLine(format: string, [&lt;System.ParamArray&gt;] args: obj []) : unit<br />System.Diagnostics.Debug.WriteLine(value: obj, category: string) : unit<br />System.Diagnostics.Debug.WriteLine(message: string, category: string) : unit</div>
<div class="tip" id="fs19">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />System.DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(ticks: int64, kind: System.DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int, calendar: System.Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: System.DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: System.Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />System.DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: System.DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs20">property System.DateTime.Now: System.DateTime</div>
<div class="tip" id="fs21">System.DateTime.ToLongTimeString() : string</div>
<div class="tip" id="fs22">Multiple items<br />module Checked<br /><br />from Microsoft.FSharp.Core.ExtraTopLevelOperators<br /><br />--------------------<br />module Checked<br /><br />from Microsoft.FSharp.Core.Operators</div>
<div class="tip" id="fs23">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs24">Multiple items<br />val ref : value:&#39;T -&gt; &#39;T ref<br /><br />Full name: Microsoft.FSharp.Core.Operators.ref<br /><br />--------------------<br />type &#39;T ref = Ref&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.ref&lt;_&gt;</div>
<div class="tip" id="fs25">Multiple items<br />type Format&lt;&#39;Printer,&#39;State,&#39;Residue,&#39;Result&gt; = PrintfFormat&lt;&#39;Printer,&#39;State,&#39;Residue,&#39;Result&gt;<br /><br />Full name: Microsoft.FSharp.Core.Format&lt;_,_,_,_&gt;<br /><br />--------------------<br />type Format&lt;&#39;Printer,&#39;State,&#39;Residue,&#39;Result,&#39;Tuple&gt; = PrintfFormat&lt;&#39;Printer,&#39;State,&#39;Residue,&#39;Result,&#39;Tuple&gt;<br /><br />Full name: Microsoft.FSharp.Core.Format&lt;_,_,_,_,_&gt;</div>
<div class="tip" id="fs26">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs27">type bool = System.Boolean<br /><br />Full name: Microsoft.FSharp.Core.bool</div>
<div class="tip" id="fs28">Multiple items<br />val decimal : value:&#39;T -&gt; decimal (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.decimal<br /><br />--------------------<br />type decimal = System.Decimal<br /><br />Full name: Microsoft.FSharp.Core.decimal<br /><br />--------------------<br />type decimal&lt;&#39;Measure&gt; = decimal<br /><br />Full name: Microsoft.FSharp.Core.decimal&lt;_&gt;</div>
<div class="tip" id="fs29">namespace System.IO</div>
<div class="tip" id="fs30">Multiple items<br />type StreamWriter =<br />&#160;&#160;inherit TextWriter<br />&#160;&#160;new : stream:Stream -&gt; StreamWriter + 6 overloads<br />&#160;&#160;member AutoFlush : bool with get, set<br />&#160;&#160;member BaseStream : Stream<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member Encoding : Encoding<br />&#160;&#160;member Flush : unit -&gt; unit<br />&#160;&#160;member Write : value:char -&gt; unit + 3 overloads<br />&#160;&#160;static val Null : StreamWriter<br /><br />Full name: System.IO.StreamWriter<br /><br />--------------------<br />System.IO.StreamWriter(stream: System.IO.Stream) : unit<br />System.IO.StreamWriter(path: string) : unit<br />System.IO.StreamWriter(stream: System.IO.Stream, encoding: System.Text.Encoding) : unit<br />System.IO.StreamWriter(path: string, append: bool) : unit<br />System.IO.StreamWriter(stream: System.IO.Stream, encoding: System.Text.Encoding, bufferSize: int) : unit<br />System.IO.StreamWriter(path: string, append: bool, encoding: System.Text.Encoding) : unit<br />System.IO.StreamWriter(path: string, append: bool, encoding: System.Text.Encoding, bufferSize: int) : unit</div>
<div class="tip" id="fs31">namespace Microsoft.FSharp.Control</div>

